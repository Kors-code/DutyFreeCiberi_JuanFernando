<mat-card>
  <mat-progress-bar mode="indeterminate" *ngIf="log" ></mat-progress-bar> 
  <div style="display: flex; justify-content: center;">
    <div style="display: flex; justify-content: center;">
      <button mat-button [matMenuTriggerFor]="menuRef"><mat-icon class="mat-18">menu</mat-icon> <span>Conteos Activos</span> </button>
      <mat-menu #menuRef="matMenu">
        <button mat-menu-item (click)="addTag('C_')" *ngIf="importar">
            <mat-icon class="mat-18" >add</mat-icon>  
            Nuevo conteo 
        </button>
        <button mat-menu-item (click)="addTag('R_')" *ngIf="importar">
          <mat-icon class="mat-18" >add</mat-icon>  
            Nueva Recepcion 
        </button>
        <ng-template let-doc let-i="index" ngFor [ngForOf]="collections">
            <button mat-menu-item (click)="getInventario(doc)" *ngIf="!verTagInventario(doc)">
                <mat-icon class="mat-18">check</mat-icon>  
                {{doc}}   
            </button>
        </ng-template> 
      </mat-menu>
    </div>
    <div style="display: flex; justify-content: center;" *ngIf="historico">
      <button mat-button [matMenuTriggerFor]="menu"><mat-icon class="mat-18">menu</mat-icon> <span>Historico</span> </button>
      <mat-menu #menu="matMenu">

        <ng-template let-doc let-i="index" ngFor [ngForOf]="collections">
            <button mat-menu-item (click)="tag = doc" *ngIf="verTagInventario(doc)">
                <mat-icon class="mat-18">check</mat-icon>  
                {{doc}}   
            </button>
        </ng-template> 
      </mat-menu>
    </div>
  </div>
  <mat-tab-group  mat-align-tabs="center" *ngIf="tag">
    <mat-tab label="IMPORTAR CONTEO" *ngIf="importar">
      <mat-card-content>
          <h2 style="text-align: center;">TOMAS DE INVENTARIOS
            <span>{{procesado}}</span>
          </h2>
          <div style="display: flex; flex-wrap: wrap; justify-content: space-around; align-items: center;">
            
            <div>
              <mat-form-field   appearance="fill" style="text-align: center; font-size: 1em; margin-right: 20px; width: 200px;">
                <input matInput placeholder="Fecha" type="text" name="Fecha" [(ngModel)]="Fecha" (change)="changeTag(Fecha)">
              </mat-form-field>
              <mat-form-field *ngIf="Fecha" appearance="fill" style="text-align: center; font-size: 1em; margin-right: 20px; width: 200px;">
                <input matInput placeholder="Marca" type="text" name="Marca" [(ngModel)]="Marca" (change)="changeTag(Marca)">
              </mat-form-field>
              <mat-form-field *ngIf="Marca" appearance="fill" style="text-align: center; font-size: 1em; margin-right: 20px; width: 200px;">
                <input matInput placeholder="Clasificacion" type="text" name="Clasificacion" [(ngModel)]="Clasificacion" (change)="changeTag(Clasificacion)">
              </mat-form-field>
              <mat-form-field *ngIf="Clasificacion" appearance="fill" style="text-align: center; font-size: 1em; margin-right: 20px; width: 200px;">
                <input matInput placeholder="Responsable" type="text" name="Responsable" [(ngModel)]="Responsable" (change)="changeTag(Responsable)">
              </mat-form-field>
            </div>
              <h2>{{db}}</h2>
              <input  type="file" multiple="false" (change)="onFileChange($event)" #fileManifiesto  style="display: none;font-size: 1.3em; margin-left: 10px;" accept=".xls, .xlsx">
              <button *ngIf="tag" mat-stroked-button size="small" slot="end" fill="outline" (click)="fileManifiesto.click()" color="tertiary">
                <mat-icon>attach_file</mat-icon>  SELECCIONA ARCHIVO
              </button>
              
              <div *ngIf="clasificacion.length != 0" style="display: flex; justify-content: center;">
                <mat-form-field appearance="fill" style="width: 60%;">
                  <mat-label>Categoria</mat-label>
                  <mat-select multiple [formControl]="clasifi"  >
                    <mat-option *ngFor="let topping of clasificacion" [value]="topping">{{topping}}</mat-option>
                  </mat-select>
                </mat-form-field>
             
              </div>
              <div *ngIf="marcas.length != 0" style="display: flex; justify-content: center;">
                <mat-form-field appearance="fill" style="width: 60%;">
                  <mat-label>Marcas</mat-label>
                  <mat-select multiple [formControl]="marca">
                    <mat-option *ngFor="let topping of marcas" [value]="topping">{{topping}}</mat-option>
                  </mat-select>
                </mat-form-field>
                <button *ngIf="marca.value.length != 0 || clasifi.value.length != 0" mat-button (click)="procesarMarca()" ><mat-icon class="mat-18">filter_list</mat-icon> <span>Filtrar Conteo</span> </button> 
              </div>
          </div>
          
          <button *ngIf="registros.length != 0" flex mat-raised-button color="accent" [disabled]="log"  (click)="subirConteo()" class="text-upper" style="width: 90%; margin:15px auto;margin-left: 20px;">{{registros.length}} Subir Conteo <mat-icon>update_file</mat-icon></button>
          <span *ngIf="progreso != 0" style="color: blue;">{{progreso | number:'0.0-2'}}% </span> <mat-progress-bar *ngIf="progreso != 0" mode="determinate" [value]="progreso" color="accent" style="width: 90%; margin: 0 auto;"></mat-progress-bar>
      
      
        </mat-card-content>
    </mat-tab>
    <mat-tab label="PANEL DE CONTEO" *ngIf="panel">
      <mat-card-content>
        <section style="display: flex;justify-content: center; margin-top: 10px;">
          <!-- <button *ngIf="tag" mat-button  mat-raised-button color="accent" [disabled]="progreso != 0"  (click)="getCnteoTag()" class="text-upper" style="width: 90%; margin:15px auto;margin-left: 20px;">MONITOREO <mat-icon>tv</mat-icon></button> -->
          <button style="margin-right:20px ;" mat-button mat-raised-button color="accent" [disabled]="progreso != 0" (click)="getCnteoTag()">
            MONITOREO <mat-icon>tv</mat-icon>
          </button>

          <button *ngIf="conteo.length != 0" style="margin-right:20px;color: white;" mat-button mat-raised-button color="primary" (click)="estado = 'iguales'" [class.accent]="estado == 'iguales'">
            <mat-icon>done_all</mat-icon>
              Iguales {{undIguales  |  number:'0.0-0'}} unds
            </button>
          <button  *ngIf="conteo.length != 0" style="margin-right:20px ;color: white;" mat-button mat-raised-button color="primary" (click)="estado = 'faltantes'" [class.accent]="estado == 'faltantes'">
            <mat-icon>do_not_disturb_on</mat-icon>
            Faltantes {{undFaltantes  |  number:'0.0-0'}} unds
          </button>
          <button *ngIf="conteo.length != 0" style="margin-right:20px ;color: white;" mat-button mat-raised-button color="primary" (click)="estado = 'sobrantes'" [class.accent]="estado == 'sobrantes'">
            <mat-icon>loupe</mat-icon>
            Sobrantes {{undSobrantes  |  number:'0.0-0'}} unds
          </button>
          <button *ngIf="conteo.length != 0" style="margin-right:20px ;color: white;" mat-button mat-raised-button color="primary" (click)="estado = 'definitivas'" [class.accent]="estado == 'definitivas'">
            <mat-icon>adjust</mat-icon>
            Definitivos    {{undDefinitivas  |  number:'0.0-0'}} unds
          </button>
          
          <button *ngIf="conteo.length != 0" style="margin-right:20px ;color: white;" mat-button mat-raised-button color="primary" (click)="estado = 'informe'" [class.accent]="estado == 'informe'">
            <mat-icon>auto_graph</mat-icon>
            Informe
          </button>
        </section>
        <div *ngIf="Iguales.length != 0 && estado == 'iguales'" >
          <h1 style="text-align:center;"> SIN DIFERENCIA  {{Iguales.length}} items 
            <button *ngIf="Iguales.length != 0 " mat-button mat-raised-button color="accent" (click)="procesarIguales()">
              <mat-icon>adjust</mat-icon>
                Definitivos 
            </button>
            <button style="margin-left:  10px;" *ngIf="Iguales.length != 0 " mat-button mat-raised-button color="warn" (click)="procesarIgualesContar()">
              <mat-icon>playlist_add_check_circle</mat-icon>
                Recontar 
            </button>
            <button style="margin-left:  10px;" *ngIf="Iguales.length != 0 " mat-button mat-raised-button color="warn" (click)="downloadFile(Iguales, 'Iguales')">
              <mat-icon>cloud_download</mat-icon>
                Descargar 
            </button>

          </h1>
          <table class="mat-elevation-z8" style="margin: 10px auto;">
            <thead style="padding: 15px; font-size: 1em; border-radius: 10px; ">
              <tr>
                <th>ITEMS</th>
                <td>{{Iguales.length  |  number:'0.0-0'}}</td>
                <th>Unds</th>
                <td>{{undIguales  |  number:'0.0-0'}}</td>
                <th>Costo USD</th>
                <td>{{usdIguales  |  number:'0.0-0'}}</td>
                <th>Costo COP</th>
                <td>{{copIguales  |  number:'0.0-0'}}</td>
              </tr>
            </thead>
          </table>
          <table class="mat-elevation-z8" style="margin: 0 auto;">
            <thead style="padding: 15px; font-size: 1em; border-radius: 10px;">
              <tr style="border: 1px solid grey;">
                <th style="border: 1px solid grey;">
                  Check
                  <mat-checkbox class="example-margin" (change)="checkIguales($event)"></mat-checkbox>
                </th>
                <th style="border: 1px solid grey;">
            
                   <span style="display:flex; align-items: center;">
                    SKU
                    <button  mat-icon-button aria-label="Clear" (click)="filterSKUIguales()">
                      <mat-icon>filter_list</mat-icon>
                    </button>
                   
                  <mat-form-field style="text-align: center; color: black;width: 90px;">
                    <input matInput  type="text" name="unds" [(ngModel)]="searcSKU">
                    <button  matSuffix mat-icon-button aria-label="Clear">
                      <mat-icon>search</mat-icon>
                    </button>
                  </mat-form-field>
                </span> 
                </th>
                <th style="border: 1px solid grey;"> 
                  <span style="display:flex; align-items: center;">EAN 
                  
                  <mat-form-field style="text-align: center; color: black;width: 130px;">
                    <input matInput  type="text" name="unds" [(ngModel)]="searcEan">
                    <button  matSuffix mat-icon-button aria-label="Clear">
                      <mat-icon>search</mat-icon>
                    </button>
                  </mat-form-field>
                </span> 
                </th>
                <th style="border: 1px solid grey;flex-direction: column;">CLA
                  <mat-form-field style="text-align: center; color: black;width: 130px;">
                    <input matInput  type="text" name="categoriaP" [(ngModel)]="searCate" (change)="verProdFilterCategoria('Iguales')">
                    <button  matSuffix mat-icon-button aria-label="Clear">
                      <mat-icon>search</mat-icon>
                    </button>
                  </mat-form-field>  
                </th>
                <th style="border: 1px solid grey;">
                  <span style="display:flex; align-items: center; flex-direction: column;">PRODUCTO
                    <mat-form-field style="text-align: center; color: black;width: 130px;">
                      <input matInput  type="text" placeholder="Categoria" name="producto" [(ngModel)]="searProd" (change)="verProdFilter('Iguales')">
                      <button  matSuffix mat-icon-button aria-label="Clear">
                        <mat-icon>search</mat-icon>
                      </button>
                    </mat-form-field>
                  </span>
                </th>
                <th style="border: 1px solid grey;">
                  <span style="display:flex; justify-content: center; align-items: center;">
                    EXISTENCIA
                    <button *ngIf="Iguales[0].Exist_Final > Iguales[Iguales.length-1].Exist_Final" mat-icon-button aria-label="Clear" (click)="filterEanIguales()">
                      <mat-icon>arrow_upward</mat-icon>
                    </button>
                    <button *ngIf="Iguales[0].Exist_Final < Iguales[Iguales.length-1].Exist_Final" mat-icon-button aria-label="Clear" (click)="filterEanIguales()">
                      <mat-icon>arrow_downward</mat-icon>
                    </button>
                  </span>
                 
                </th>
                <th style="border: 1px solid grey;">CONTEO</th>
                <!-- <th>DIFERENCIA</th> -->
                <th style="border: 1px solid grey;">CONTEOS</th>
                <th style="border: 1px solid grey;">COSTO USD</th>
                <th style="border: 1px solid grey;">
                  <span style="display:flex; justify-content: center; align-items: center;">
                  COSTO COP
                  <button *ngIf="Iguales[0].TOTAL_FINAL_INV > Iguales[Iguales.length-1].TOTAL_FINAL_INV" mat-icon-button aria-label="Clear" (click)="filterCOPIguales()">
                    <mat-icon>arrow_upward</mat-icon>
                  </button>
                  <button *ngIf="Iguales[0].TOTAL_FINAL_INV < Iguales[Iguales.length-1].TOTAL_FINAL_INV" mat-icon-button aria-label="Clear" (click)="filterCOPIguales()">
                    <mat-icon>arrow_downward</mat-icon>
                  </button>
                </span>
                </th>
                <!-- <th>DEFINITIVO</th> -->
              </tr>
            </thead>
            <tbody>
              <ng-template  let-element let-last="last" ngFor [ngForOf]="Iguales" >
                <tr *ngIf="searcSKU == '' && element.EAN == searcEan ||
                           searcEan  == '' && element.Codigo1 == searcSKU ||
                           searcEan  == '' &&   searcSKU == '' ||
                           element.Codigo1 == searcSKU && element.EAN == searcEan">
                  <td style="border-bottom: 1px solid grey ; text-align: center;">  <mat-checkbox class="example-margin" [(ngModel)]="element.check"></mat-checkbox></td> 
                  <td style="border-bottom: 1px solid grey ;"> {{element.Codigo1}}</td>
                  <td style="border-bottom: 1px solid grey ;"> {{element.EAN}}</td>
                  <td style="border-bottom: 1px solid grey ; text-align: center;"> {{element.Cla}}</td>
                  <td style="border-bottom: 1px solid grey;"> {{element.Descripcion_1}}</td>
                  <td style="text-align: center; border-bottom: 1px solid grey ;"> {{element.Exist_Final}}</td>
                  <td style="border-bottom: 1px solid grey ;text-align: center;" class="selec" [matMenuTriggerFor]="menu" *ngIf="element.Conteo0.length != 0">   
                    <!-- <span > -->
                    <!-- <mat-icon  > fullscreen </mat-icon> -->
                      {{cuantas(element.Conteo0)}}
                    <mat-menu #menu="matMenu">
                      <button mat-menu-item (click)="passRegistro(element.Conteo0)">Ver Conteo</button>
                      <button mat-menu-item (click)="conteoDefinitivo(element)">Definitivo</button>
                      <button mat-menu-item (click)="conteo1(element)" *ngIf="element.Conteo1.length == 0">Conteo 1</button>
                      <button mat-menu-item (click)="conteo2(element)" *ngIf="element.Conteo1.length != 0 && element.Conteo2.length == 0 ">Conteo 2</button>
                      <button mat-menu-item (click)="conteo3(element)" *ngIf="element.Conteo2.length != 0 && element.Conteo3.length == 0">Conteo 3</button>
                      <button mat-menu-item (click)="conteo4(element)" *ngIf="element.Conteo3.length != 0 && element.Conteo4.length == 0">Conteo 4</button>
                    </mat-menu>
                  <!-- </span> -->
                  
                  </td>
                  <!-- <td style="border-bottom: 1px solid grey ;"> {{cuantas(element.Conteo0) - element.Exist_Final}} </td> -->
                  <td style="border-bottom: 1px solid grey ;">
                     <span class="selec" *ngIf="element.Definitivo.length != 0">
                       {{cuantas(element.Definitivo)}}
                      <mat-icon> done_all </mat-icon> 
                     </span>
                     <span  (click)="conteoDefinitivoDefinitivo(element.Conteo1, element._id, element)" class="selec" *ngIf="element.Conteo1.length != 0">
                      [1] - [{{ cuantas(element.Conteo1)}} unds  ]
                     </span>
                     <span (click)="conteoDefinitivoDefinitivo(element.Conteo2, element._id, element)" class="selec" *ngIf="element.Conteo2.length != 0">
                      [2] - [{{ cuantas(element.Conteo2)}} unds  ]
                     </span>
                     <span (click)="conteoDefinitivoDefinitivo(element.Conteo3, element._id, element)" class="selec" *ngIf="element.Conteo3.length != 0">
                      [3] - [{{ cuantas(element.Conteo3)}} unds  ]
                     </span>
                     <span (click)="conteoDefinitivoDefinitivo(element.Conteo4, element._id, element)" class="selec"*ngIf="element.Conteo4.length != 0">
                      [4] - [{{ cuantas(element.Conteo4)}} unds  ]
                     </span>

                     <mat-menu #menudes="matMenu">
                      <button mat-menu-item (click)="passRegistro(element.Conteo0)">Ver Conteo</button>
                      <button mat-menu-item (click)="conteoDefinitivo(element)">Definitivo</button>
                      
                    </mat-menu>
                  </td>
                  <td style="text-align:right; border-bottom: 1px solid grey ;">
                    {{element.TOTAL_FINAL_INV_USD  |  number:'0.0-0'}}
                  </td>
                  <td style="text-align:right; border-bottom: 1px solid grey ;">
                    {{element.TOTAL_FINAL_INV |  number:'0.0-0'}}
                  </td>
                  <!-- <td [class._50]="element.Definitivo.length - element.Exist_Final <= -1" [class._100]="element.Definitivo.length - element.Exist_Final == 0"> {{element.Definitivo.length - element.Exist}} </td> -->
                </tr>
              </ng-template>
            </tbody>

          </table>
        </div>
        <span *ngIf="up != 0" style="color: blue;">{{up | number:'0.0-2'}}% </span> 
        <mat-progress-bar *ngIf="up != 0" mode="determinate" [value]="up" color="accent" style="width: 90%; margin: 0 auto;"></mat-progress-bar>
        <div *ngIf="Faltantes.length != 0 && estado == 'faltantes'" >
          <h1 style="text-align:center;">FALTANTES  {{Faltantes.length}} items 
          
            <button *ngIf="Faltantes.length != 0 " mat-button mat-raised-button color="accent" (click)="procesarFaltantes()">
              <mat-icon>adjust</mat-icon>
                Definitivos 
            </button>
            <button style="margin-left:  10px; color: white;" *ngIf="Faltantes.length != 0 " mat-button mat-raised-button color="warn" (click)="printFaltantes()">
              <mat-icon>print</mat-icon>
                Imprimir 
            </button>
            <button style="margin-left:  10px;" *ngIf="Faltantes.length != 0 " mat-button mat-raised-button color="warn" (click)="downloadFile(Faltantes, 'Faltantes')">
              <mat-icon>cloud_download</mat-icon>
                Descargar 
            </button>
          </h1>
          <table class="mat-elevation-z8" style="margin: 20px auto;">
            <thead style="padding: 15px; font-size: 1em; border-radius: 10px;">
              <tr>
                <th>ITEMS</th>
                <td>{{Faltantes.length  |  number:'0.0-0'}}</td>
                <th>Unds</th>
                <td>{{undFaltantes  |  number:'0.0-0'}}</td>
                <th>Costo USD</th>
                <td>{{usdFaltantes  |  number:'0.0-0'}}</td>
                <th>Costo COP</th>
                <td>{{copFaltantes  |  number:'0.0-0'}}</td>
              </tr>

            </thead>
          </table>
          <table class="mat-elevation-z8" style="margin: 0 auto;">
            <thead style="padding: 15px; font-size: 1em; border-radius: 10px;">
              <tr >
                <th style="border: 1px solid grey;">
                  Check
                  <mat-checkbox class="example-margin" (change)="checkFaltantes($event)"></mat-checkbox>
                  </th>
                <th style="border: 1px solid grey;">
            
                   <span style="display:flex; align-items: center;">SKU
                    <button *ngIf="Faltantes[0].Exist_Final > Faltantes[Faltantes.length-1].Exist_Final" mat-icon-button aria-label="Clear" (click)="filterSKUFaltantes()">
                      <mat-icon>arrow_upward</mat-icon>
                    </button>
                    <button *ngIf="Faltantes[0].Exist_Final < Faltantes[Faltantes.length-1].Exist_Final" mat-icon-button aria-label="Clear" (click)="filterSKUFaltantes()">
                      <mat-icon>arrow_downward</mat-icon>
                    </button>
                  <mat-form-field style="text-align: center; color: black;width: 90px;">
                    <input matInput  type="text" name="unds" [(ngModel)]="searcSKU">
                    <button  matSuffix mat-icon-button aria-label="Clear">
                      <mat-icon>search</mat-icon>
                    </button>
                  </mat-form-field>
                </span> 
                </th>
                <th style="border: 1px solid grey;"> 
                  <span style="display:flex; align-items: center;">EAN 
                  
                  <mat-form-field style="text-align: center; color: black;width: 130px;">
                    <input matInput  type="text" name="unds" [(ngModel)]="searcEan">
                    <button  matSuffix mat-icon-button aria-label="Clear">
                      <mat-icon>search</mat-icon>
                    </button>
                  </mat-form-field>
                </span> 
                </th>
                <th style="border: 1px solid grey;">
                  <span style="display:flex; align-items: center;flex-direction: column;">CLA
                    <mat-form-field style="text-align: center; color: black;width: 130px;">
                      <input matInput  type="text" name="searCate" [(ngModel)]="searCate" (change)="verProdFilterCategoria('Faltantes')">
                      <button  matSuffix mat-icon-button aria-label="Clear">
                        <mat-icon>search</mat-icon>
                      </button>
                    </mat-form-field>
                  </span>
                </th>
                <th style="border: 1px solid grey;">
                  <span style="display:flex; align-items: center; flex-direction: column;">PRODUCTO
                    <mat-form-field style="text-align: center; color: black;width: 130px;">
                      <input matInput  type="text" name="producto" [(ngModel)]="searProd" (change)="verProdFilter('Faltantes')">
                      <button  matSuffix mat-icon-button aria-label="Clear">
                        <mat-icon>search</mat-icon>
                      </button>
                    </mat-form-field>
                  </span>
                </th>
                <th style="border: 1px solid grey;">
                  <span style="display:flex; justify-content: center; align-items: center;">
                    EXISTENCIA
                    <button *ngIf="Faltantes[0].Exist_Final > Faltantes[Faltantes.length-1].Exist_Final" mat-icon-button aria-label="Clear" (click)="filterEanFaltantes()">
                      <mat-icon>arrow_upward</mat-icon>
                    </button>
                    <button *ngIf="Faltantes[0].Exist_Final < Faltantes[Faltantes.length-1].Exist_Final" mat-icon-button aria-label="Clear" (click)="filterEanFaltantes()">
                      <mat-icon>arrow_downward</mat-icon>
                    </button>
                  </span>
                 
                </th>
                <th style="border: 1px solid grey;">CONTEO</th>
                <th style="border: 1px solid grey;">DIFERENCIA</th>
                <th style="border: 1px solid grey;">CONTEOS</th>
                <th style="border: 1px solid grey;">COSTO USD</th>
                <th style="border: 1px solid grey;">
                  <span style="display:flex; justify-content: center; align-items: center;">
                  COSTO COP
                  <button *ngIf="Faltantes[0].COST_PROM > Faltantes[Faltantes.length-1].COST_PROM" mat-icon-button aria-label="Clear" (click)="filterCOPFaltantes()">
                    <mat-icon>arrow_upward</mat-icon>
                  </button>
                  <button *ngIf="Faltantes[0].COST_PROM < Faltantes[Faltantes.length-1].COST_PROM" mat-icon-button aria-label="Clear" (click)="filterCOPFaltantes()">
                    <mat-icon>arrow_downward</mat-icon>
                  </button>
                </span>
                </th>
                <!-- <th>DEFINITIVO</th> -->
              </tr>
            </thead>
            <tbody>
              <ng-template  let-element let-last="last" ngFor [ngForOf]="Faltantes" >
                <tr *ngIf="searcSKU == '' && element.EAN == searcEan ||
                searcEan  == '' && element.Codigo1 == searcSKU ||
                searcEan  == '' &&   searcSKU == ''  ||
                element.Codigo1 == searcSKU && element.EAN == searcEan">
                  <td style="border-bottom: 1px solid grey ; text-align: center;">  <mat-checkbox class="example-margin" [(ngModel)]="element.check"></mat-checkbox></td> 
                  <td style="border-bottom: 1px solid grey ;"> {{element.Codigo1}}</td>
                  <td style="border-bottom: 1px solid grey ;"> {{element.EAN}}</td>
                  <td style="border-bottom: 1px solid grey ;"> {{element.Cla}}</td>
                  <td style="border-bottom: 1px solid grey ;"> {{element.Descripcion_1}}</td>
                  <td style="text-align: center; border-bottom: 1px solid grey ;"> {{element.Exist_Final}}</td>
                  <td style="border-bottom: 1px solid grey ;">   
                    <span class="selec" [matMenuTriggerFor]="menu" *ngIf="element.Conteo0.length != 0">
                    <!-- <mat-icon  > fullscreen </mat-icon>  -->
                     {{cuantas(element.Conteo0)}}
                    <mat-menu #menu="matMenu">
                      <button mat-menu-item (click)="passRegistro(element.Conteo0)">Ver Conteo</button>
                      <button mat-menu-item (click)="conteoDefinitivo(element)">Definitivo</button>
                      <button mat-menu-item (click)="conteo1(element)" *ngIf="element.Conteo1.length == 0">Conteo 1</button>
                      <button mat-menu-item (click)="conteo2(element)" *ngIf="element.Conteo1.length != 0 && element.Conteo2.length == 0 ">Conteo 2</button>
                      <button mat-menu-item (click)="conteo3(element)" *ngIf="element.Conteo2.length != 0 && element.Conteo3.length == 0">Conteo 3</button>
                      <button mat-menu-item (click)="conteo4(element)" *ngIf="element.Conteo3.length != 0 && element.Conteo4.length == 0">Conteo 4</button>
                    </mat-menu>
                  </span>
                  
                  </td>
                  <td style="border-bottom: 1px solid grey;" [class._50]="cuantas(element.Conteo0) - element.Exist_Final <= -1" [class._100]="cuantas(element.Conteo0) - element.Exist_Final == 0"> {{cuantas(element.Conteo0) - element.Exist_Final}} </td>
                  <td style="border-bottom: 1px solid grey ;width:120px;">
                  
                    <!-- <span class="selec">
                     <mat-icon  (click)="passRegistro(element.Definitivo)">remove_red_eye</mat-icon> Ver
                    </span> -->

                     <span class="selec" *ngIf="element.Definitivo.length != 0">
                      <mat-icon> done_all </mat-icon> 
                      {{cuantas(element.Definitivo)}} unds
                     
                     </span>
                     <span  (click)="conteoDefinitivoDefinitivo(element.Conteo1, element._id, element)" class="selec" *ngIf="element.Conteo1.length != 0" style="display: flex;align-items: center">
                     [1] - [{{ cuantas(element.Conteo1)}} unds ] 
                     </span>
                     <span (click)="conteoDefinitivoDefinitivo(element.Conteo2, element._id, element)" class="selec" *ngIf="element.Conteo2.length != 0">
                      [2] - [{{ cuantas(element.Conteo2)}} unds ] 
                     </span>
                     <span (click)="conteoDefinitivoDefinitivo(element.Conteo3, element._id, element)" class="selec" *ngIf="element.Conteo3.length != 0">
                      [3] - [{{ cuantas(element.Conteo3)}} unds ] 
                     </span>
                     <span (click)="conteoDefinitivoDefinitivo(element.Conteo4, element._id, element)" class="selec"*ngIf="element.Conteo4.length != 0">
                      [4] - [{{ cuantas(element.Conteo4)}} unds ] 
                     </span>
                  </td>
                  <td style="text-align:right; border-bottom: 1px solid grey ;">
                    {{element.TOTAL_FINAL_INV_USD  |  number:'0.0-0'}}
                  </td>
                  <td style="text-align:right ; border-bottom: 1px solid grey ;">
                    {{element.TOTAL_FINAL_INV |  number:'0.0-0'}}
                  </td>
                  <!-- <td [class._50]="element.Definitivo.length - element.Exist_Final <= -1" [class._100]="element.Definitivo.length - element.Exist == 0"> {{element.Definitivo.length - element.Exist}} </td> -->
                </tr>
              </ng-template>
           

            </tbody>
          </table>
        </div>
        <div *ngIf="Sobrantes.length != 0 && estado == 'sobrantes'" >
          <h1 style="text-align:center;">SOBRANTES {{Sobrantes.length}} items
            <button *ngIf="Sobrantes.length != 0 " mat-button mat-raised-button color="accent" (click)="procesarSobrantes()">
              <mat-icon>adjust</mat-icon>
                Definitivos 
            </button>
            <button style="margin-left:  10px; color: white;" *ngIf="Sobrantes.length != 0 " mat-button mat-raised-button color="warn" (click)="printSobrantes()">
              <mat-icon>print</mat-icon>
                Imprimir 
            </button>
            <button style="margin-left:  10px;" *ngIf="Sobrantes.length != 0 " mat-button mat-raised-button color="warn" (click)="downloadFile(Sobrantes, 'Sobrantes')">
              <mat-icon>cloud_download</mat-icon>
                Descargar 
            </button>
          </h1>
          <table class="mat-elevation-z8" style="margin: 20px auto;">
            <thead style="padding: 15px; font-size: 1em; border-radius: 10px;">
              <tr>
                <th>ITEMS</th>
                <td>{{Sobrantes.length  |  number:'0.0-0'}}</td>
                <th>Unds</th>
                <td>{{undSobrantes  |  number:'0.0-0'}}</td>
                <th>Costo USD</th>
                <td>{{usdSobrantes  |  number:'0.0-0'}}</td>
                <th>Costo COP</th>
                <td>{{copSobrantes  |  number:'0.0-0'}}</td>
              </tr>

            </thead>
          </table>
          <table class="mat-elevation-z8" style="margin: 0 auto;">
            <thead style="padding: 15px; font-size: 1em; border-radius: 10px;">
              <tr >
                <th style="border: 1px solid grey;">
                  Check
                  <mat-checkbox class="example-margin" (change)="checkSobrantes($event)"></mat-checkbox>
                  </th>
                <th style="border: 1px solid grey;">
            
                   <span style="display:flex; align-items: center;">SKU
                    <button *ngIf="Sobrantes[0].Exist_Final > Sobrantes[Sobrantes.length-1].Exist_Final" mat-icon-button aria-label="Clear" (click)="filterSKUSobrantes()">
                      <mat-icon>arrow_upward</mat-icon>
                    </button>
                    <button *ngIf="Sobrantes[0].Exist_Final < Sobrantes[Sobrantes.length-1].Exist_Final" mat-icon-button aria-label="Clear" (click)="filterSKUSobrantes()">
                      <mat-icon>arrow_downward</mat-icon>
                    </button>
                  <mat-form-field style="text-align: center; color: black;width: 90px;">
                    <input matInput  type="text" name="unds" [(ngModel)]="searcSKU">
                    <button  matSuffix mat-icon-button aria-label="Clear">
                      <mat-icon>search</mat-icon>
                    </button>
                  </mat-form-field>
                </span> 
                </th>
                <th style="border: 1px solid grey;"> 
                  <span style="display:flex; align-items: center;">EAN 
                  
                  <mat-form-field style="text-align: center; color: black;width: 130px;">
                    <input matInput  type="text" name="unds" [(ngModel)]="searcEan">
                    <button  matSuffix mat-icon-button aria-label="Clear">
                      <mat-icon>search</mat-icon>
                    </button>
                  </mat-form-field>
                </span> 
                </th>
                <th style="border: 1px solid grey;">
                  <span style="display:flex; align-items: center; flex-direction: column;">CLA
                    <mat-form-field style="text-align: center; color: black;width: 130px;">
                      <input matInput  type="text" name="searCate" [(ngModel)]="searCate" (change)="verProdFilterCategoria('Sobrantes')">
                      <button  matSuffix mat-icon-button aria-label="Clear">
                        <mat-icon>search</mat-icon>
                      </button>
                    </mat-form-field>
                  </span>
                </th>
                <th style="border: 1px solid grey;">
                  <span style="display:flex; align-items: center; flex-direction: column;">PRODUCTO
                    <mat-form-field style="text-align: center; color: black;width: 130px;">
                      <input matInput  type="text" name="producto" [(ngModel)]="searProd" (change)="verProdFilter('Sobrantes')">
                      <button  matSuffix mat-icon-button aria-label="Clear">
                        <mat-icon>search</mat-icon>
                      </button>
                    </mat-form-field>
                  </span>
                </th>
                <th style="border: 1px solid grey;">
                  <span style="display:flex; justify-content: center; align-items: center;">
                    EXISTENCIA
                    <button *ngIf="Sobrantes[0].Exist_Final > Sobrantes[Sobrantes.length-1].Exist_Final" mat-icon-button aria-label="Clear" (click)="filterEanSobrantes()">
                      <mat-icon>arrow_upward</mat-icon>
                    </button>
                    <button *ngIf="Sobrantes[0].Exist_Final < Sobrantes[Sobrantes.length-1].Exist_Final" mat-icon-button aria-label="Clear" (click)="filterEanSobrantes()">
                      <mat-icon>arrow_downward</mat-icon>
                    </button>
                  </span>
                 
                </th>
                <th style="border: 1px solid grey;">CONTEO</th>
                <th style="border: 1px solid grey;">DIFERENCIA</th>
                <th style="border: 1px solid grey;">CONTEOS</th>
                <th style="border: 1px solid grey;">COSTO USD</th>
                <th style="border: 1px solid grey;">
                  <span style="display:flex; justify-content: center; align-items: center;">
                  COSTO COP
                  <button *ngIf="Sobrantes[0].COST_PROM > Sobrantes[Sobrantes.length-1].COST_PROM" mat-icon-button aria-label="Clear" (click)="filterCOPSobrantes()">
                    <mat-icon>arrow_upward</mat-icon>
                  </button>
                  <button *ngIf="Sobrantes[0].COST_PROM < Sobrantes[Sobrantes.length-1].COST_PROM" mat-icon-button aria-label="Clear" (click)="filterCOPSobrantes()">
                    <mat-icon>arrow_downward</mat-icon>
                  </button>
                </span>
                </th>
                <!-- <th>DEFINITIVO</th> -->
              </tr>
            </thead>
            <tbody>
              <ng-template  let-element let-last="last" ngFor [ngForOf]="Sobrantes" >
                <tr *ngIf="searcSKU == '' && element.EAN == searcEan ||
                searcEan  == '' && element.Codigo1 == searcSKU ||
                searcEan  == '' &&   searcSKU == ''  ||
                element.Codigo1 == searcSKU && element.EAN == searcEan">
                  <td style="border-bottom: 1px solid grey ; text-align: center;">  <mat-checkbox class="example-margin" [(ngModel)]="element.check"></mat-checkbox></td> 
                  <td style="border-bottom: 1px solid grey;"> {{element.Codigo1}}</td>
                  <td style="border-bottom: 1px solid grey;"> {{element.EAN}}</td>
                  <td style="border-bottom: 1px solid grey; text-align: center;"> {{element.Cla}}</td>
                  <td style="border-bottom: 1px solid grey;"> {{element.Descripcion_1}}</td>
                  <td style="text-align: center;border-bottom: 1px solid grey;"> {{element.Exist_Final}}</td>
                  <td style="border-bottom: 1px solid grey;">   
                    <span class="selec" [matMenuTriggerFor]="menu" *ngIf="element.Conteo0.length != 0">
                    
                     {{cuantas(element.Conteo0)}}
                    <mat-menu #menu="matMenu">
                      <button mat-menu-item (click)="passRegistro(element.Conteo0)">Ver Conteo</button>
                      <button mat-menu-item (click)="conteoDefinitivo(element)">Definitivo</button>
                      <button mat-menu-item (click)="conteo1(element)" *ngIf="element.Conteo1.length == 0">Conteo 1</button>
                      <button mat-menu-item (click)="conteo2(element)" *ngIf="element.Conteo1.length != 0 && element.Conteo2.length == 0 ">Conteo 2</button>
                      <button mat-menu-item (click)="conteo3(element)" *ngIf="element.Conteo2.length != 0 && element.Conteo3.length == 0">Conteo 3</button>
                      <button mat-menu-item (click)="conteo4(element)" *ngIf="element.Conteo3.length != 0 && element.Conteo4.length == 0">Conteo 4</button>
                    </mat-menu>
                  </span>
                  
                  </td>
                  <td style="border-bottom: 1px solid grey;" [class._50]="cuantas(element.Conteo0) - element.Exist_Final <= -1" [class._100]="cuantas(element.Conteo0) - element.Exist_Final == 0"  [class._90]="cuantas(element.Conteo0) - element.Exist_Final >= 1"> {{cuantas(element.Conteo0) - element.Exist_Final}} </td>
                  <td style="border-bottom: 1px solid grey ;width:120px;">
                   
                     <span class="selec" *ngIf="element.Definitivo.length != 0"  (click)="passRegistro(element.Definitivo)">
                      {{cuantas(element.Definitivo)}}
                      <mat-icon> done_all </mat-icon> 
                     </span>
                     <span  (click)="conteoDefinitivoDefinitivo(element.Conteo1, element._id, element)" class="selec" *ngIf="element.Conteo1.length != 0">
                      [1] - [{{ cuantas(element.Conteo1)}} unds ] 
                     </span>
                     <span (click)="conteoDefinitivoDefinitivo(element.Conteo2, element._id, element)" class="selec" *ngIf="element.Conteo2.length != 0">
                      [2] - [{{ cuantas(element.Conteo2)}} unds ] 
                     </span>
                     <span (click)="conteoDefinitivoDefinitivo(element.Conteo3, element._id, element)" class="selec" *ngIf="element.Conteo3.length != 0">
                      [3] - [{{ cuantas(element.Conteo3)}} unds ] 
                     </span>
                     <span (click)="conteoDefinitivoDefinitivo(element.Conteo4, element._id, element)" class="selec"*ngIf="element.Conteo4.length != 0">
                      [4] - [{{ cuantas(element.Conteo4)}} unds ] 
                     </span>
                  </td>
                  <td style="text-align:right;border-bottom: 1px solid grey;">
                    {{element.TOTAL_FINAL_INV_USD  |  number:'0.0-0'}}
                  </td>
                  <td style="text-align:right ;border-bottom: 1px solid grey;">
                    {{element.TOTAL_FINAL_INV |  number:'0.0-0'}}
                  </td>
                  <!-- <td [class._50]="element.Definitivo.length - element.Exist <= -1" [class._100]="element.Definitivo.length - element.Exist == 0"> {{element.Definitivo.length - element.Exist}} </td>  -->
                </tr>
              </ng-template>
            </tbody>
          </table>

        </div>
        <div *ngIf="conteo.length != 0 && estado == 'definitivas'" >
          
          <h1 style="text-align:center;">DEFINITIVOS {{Definitivas.length}} items
            <button style="margin-left:  10px; color: white;" *ngIf="Definitivas.length != 0 " mat-button mat-raised-button color="warn" (click)="printDefinitivos()">
              <mat-icon>print</mat-icon>
                Imprimir 
            </button>
            <button style="margin-left:  10px;" *ngIf="Definitivas.length != 0 " mat-button mat-raised-button color="warn" (click)="downloadFile(Definitivas, 'Definitivas')">
              <mat-icon>cloud_download</mat-icon>
                Descargar 
            </button>
          </h1>
          <div *ngIf="Definitivas.length !=0">
            <table class="mat-elevation-z8" style="margin: 20px auto;">
              <thead style="padding: 15px; font-size: 1em; border-radius: 10px;">
                <tr>
                  <th>ITEMS</th>
                  <td style="text-align:rigth ;">{{Definitivas.length  |  number:'0.0-0'}}</td>
                  <th>Unds</th>
                  <td style="text-align:rigth ;">{{undDefinitivas  |  number:'0.0-0'}}</td>
                  <th>Costo USD</th>
                  <td style="text-align:rigth ;">{{usdDefinitivas  |  number:'0.0-0'}}</td>
                  <th>Costo COP</th>
                  <td style="text-align:rigth ;">{{copDefinitivas  |  number:'0.0-0'}}</td>
                </tr>
                <tr>
                  <th></th>
                  <td></td>
                  <th>Conteo</th>
                  <td style="text-align:rigth ;">{{undDefinitivasConteo  |  number:'0.0-0'}}</td>
                  <th>Conteo USD</th>
                  <td style="text-align:rigth ;">{{usdDefinitivasConteo |  number:'0.0-0'}}</td>
                  <th>Conteo COP</th>
                  <td style="text-align:rigth ;">{{ copDefinitivasConteo |  number:'0.0-0'}}</td>
                </tr>
                <tr>
                  <th></th>
                  <td></td>
                  <th>DIF</th>
                  <td style="text-align:rigth ;">{{undDefinitivasConteo - undDefinitivas   |  number:'0.0-0'}}</td>
                  <th>DIF USD</th>
                  <td style="text-align:rigth ;">{{usdDefinitivasConteo - usdDefinitivas |  number:'0.0-0'}}</td>
                  <th>DIF COP</th>
                  <td style="text-align:rigth ;">{{copDefinitivasConteo - copDefinitivas |  number:'0.0-0'}}</td>
                </tr>
  
              </thead>
            </table>
            <table class="mat-elevation-z8" style="margin: 0 auto;">
              <thead style="padding: 15px; font-size: 1em; border-radius: 10px;">
                <tr>
                  <th style="border: 1px solid grey;">
                     <span style="display:flex; align-items: center;">SKU
                    <!-- <mat-form-field style="text-align: center; color: black;width: 90px;">
                      <input matInput  type="text" name="unds" [(ngModel)]="searcSKU">
                      <button  matSuffix mat-icon-button aria-label="Clear">
                        <mat-icon>search</mat-icon>
                      </button>
                    </mat-form-field> -->
                  </span> 
                  </th>
                  <th style="border: 1px solid grey;" > 
                    <span style="display:flex; align-items: center;">EAN 
                    
                    <mat-form-field style="text-align: center; color: black;width: 130px;">
                      <input matInput  type="text" name="unds" [(ngModel)]="searcEan">
                      <button  matSuffix mat-icon-button aria-label="Clear">
                        <mat-icon>search</mat-icon>
                      </button>
                    </mat-form-field>
                  </span> 
                  </th>
                  <th style="border: 1px solid grey; flex-direction: column;">
                    <span style="display:flex; align-items: center;">CLA
                      <mat-form-field style="text-align: center; color: black;width: 130px;">
                        <input matInput  type="text" name="searCate" [(ngModel)]="searCate" (change)="verProdFilterCategoria('Definitivas')">
                        <button  matSuffix mat-icon-button aria-label="Clear">
                          <mat-icon>search</mat-icon>
                        </button>
                      </mat-form-field>
                    </span>
                  
                  </th>
                  <th style="border: 1px solid grey;">
                    <span style="display:flex; align-items: center; flex-direction: column;">PRODUCTO
                      <mat-form-field style="text-align: center; color: black;width: 130px;">
                        <input matInput  type="text" name="producto" [(ngModel)]="searProd" (change)="verProdFilter('Definitivas')">
                        <button  matSuffix mat-icon-button aria-label="Clear">
                          <mat-icon>search</mat-icon>
                        </button>
                      </mat-form-field>
                    </span>
                  </th>
                  <th style="border: 1px solid grey;">
                    <span style="display:flex; justify-content: center; align-items: center;">
                      EXISTENCIA
                      <button *ngIf="Definitivas[0].Exist_Final > Definitivas[Definitivas.length-1].Exist_Final" mat-icon-button aria-label="Clear" (click)="filterExistDefinitivos()">
                        <mat-icon>arrow_upward</mat-icon>
                      </button>
                      <button *ngIf="Definitivas[0].Exist_Final < Definitivas[Definitivas.length-1].Exist_Final" mat-icon-button aria-label="Clear" (click)="filterExistDefinitivos()">
                        <mat-icon>arrow_downward</mat-icon>
                      </button>
                    </span>
                  </th>
                  <th style="border: 1px solid grey;">CONTEO</th>
                  <th style="border: 1px solid grey;">DIFERENCIA</th>
                  <th style="border: 1px solid grey;">CONTEOS</th>
                  <th style="border: 1px solid grey;">UND USD</th>
                  <th style="border: 1px solid grey;">
                    <span style="display:flex; justify-content: center; align-items: center;">
                    UND COP
                    <button *ngIf="Definitivas[0].COST_PROM > Definitivas[Definitivas.length-1].COST_PROM" mat-icon-button aria-label="Clear" (click)="filterCOPFaltantes()">
                      <mat-icon>arrow_upward</mat-icon>
                    </button>
                    <button *ngIf="Definitivas[0].COST_PROM < Definitivas[Definitivas.length-1].COST_PROM" mat-icon-button aria-label="Clear" (click)="filterCOPFaltantes()">
                      <mat-icon>arrow_downward</mat-icon>
                    </button>
                  </span>
                  </th>
                  <th style="border: 1px solid grey;"> TOTAL USD</th>
                  <th style="border: 1px solid grey;"> TOTAL COP</th>
                  <!-- <th>DEFINITIVO</th> -->
                  <th  style="border: solid 1px grey ;">JUSTIFICACION</th>
                </tr>
              </thead>
              <tbody>
                <ng-template  let-element let-last="last" ngFor [ngForOf]="Definitivas" >
                  <tr *ngIf="searcSKU == '' && element.EAN == searcEan ||
                  searcEan  == '' && element.Codigo1 == searcSKU ||
                  searcEan  == '' &&   searcSKU == ''  ||
                  element.Codigo1 == searcSKU && element.EAN == searcEan">
                    <td style="border-bottom: 1px solid grey;"> {{element.Codigo1}}</td>
                    <td style="border-bottom: 1px solid grey;"> {{element.EAN}}</td>
                    <td style="border-bottom: 1px solid grey;"> {{element.Cla}}</td>
                    <td style="border-bottom: 1px solid grey;"> {{element.Descripcion_1}}</td>
                    <td style="text-align: center; border-bottom: 1px solid grey;"> {{element.Exist_Final}}</td>
                    <td style="border-bottom: 1px solid grey;">   
                      <span class="selec">
                      {{element.Conteo}}
                      </span>
                    </td>
                    <td style="border-bottom: 1px solid grey;" [class._50]="element.Conteo - element.Exist_Final <= -1" [class._100]="element.Conteo - element.Exist_Final == 0"  [class._90]="element.Conteo - element.Exist_Final >= 1" style="border-bottom: 1px solid grey;"> {{element.Conteo - element.Exist_Final}} </td>
                    <td style="border-bottom: 1px solid grey ;width:120px;">
                       <!-- <span (click)="passRegistro(element.Definitivo)" class="selec" *ngIf="element.Definitivo.length != 0">
                        {{cuantas(element.Definitivo)}}
                        <mat-icon> done_all </mat-icon> 
                       </span> -->
                       <span  (click)="conteoDefinitivoDefinitivo(element.Conteo1, element._id, element)" class="selec" *ngIf="element.Conteo1.length != 0">
                        [1] - [{{ cuantas(element.Conteo1)}} unds ] 
                       </span>
                       <span (click)="conteoDefinitivoDefinitivo(element.Conteo2, element._id, element)" class="selec" *ngIf="element.Conteo2.length != 0">
                        [2] - [{{ cuantas(element.Conteo2)}} unds ] 
                       </span>
                       <span (click)="conteoDefinitivoDefinitivo(element.Conteo3, element._id, element)" class="selec" *ngIf="element.Conteo3.length != 0">
                        [3] - [{{ cuantas(element.Conteo3)}} unds ] 
                       </span>
                       <span (click)="conteoDefinitivoDefinitivo(element.Conteo4, element._id, element)" class="selec"*ngIf="element.Conteo4.length != 0">
                        [4] - [{{ cuantas(element.Conteo4)}} unds ] 
                       </span>
                    </td>
                    <td style="text-align:right; border-bottom: 1px solid grey;">
                      {{element.TOTAL_FINAL_INV_USD  |  number:'0.0-2'}}
                    </td>
                    <td style="text-align:right; border-bottom: 1px solid grey;">
                      {{element.TOTAL_FINAL_INV |  number:'0.0-0'}}
                    </td>
                    <td style="text-align:right; border-bottom: 1px solid grey;">
                      {{element.TOTAL_FINAL_INV_USD * element.Diferencia |  number:'0.0-2'}}
                    </td>
                    <td style="text-align:right; border-bottom: 1px solid grey;">
                      {{element.TOTAL_FINAL_INV * element.Diferencia |  number:'0.0-0'}}
                    </td>
                    <td style="text-align:right; border-bottom: 1px solid grey;">
                      <mat-form-field  appearance="fill" style="text-align: center; font-size: 1em; margin-right: 20px; width: 200px;">
                        <textarea matInput placeholder="Justificacion" type="text" name="tagS" [(ngModel)]="element.justificacion"></textarea>
                        <button (click)="justificar(element)" matSuffix mat-icon-button aria-label="Guardar">
                          <mat-icon>save</mat-icon>
                        </button>
                      </mat-form-field>
                    </td>
 
                    <!-- <td [class._50]="element.Definitivo.length - element.Exist <= -1" [class._100]="element.Definitivo.length - element.Exist == 0"> {{element.Definitivo.length - element.Exist}} </td> -->
                  </tr>
                </ng-template>
             
  
              </tbody>
  
            </table>
          </div>
          

        </div>
        <div *ngIf="conteo.length != 0 && estado == 'informe'">
        
          <h1 style="text-align:center ;"> DUTY FREE PARTNERS COLOMBIA SAS</h1>
           <h1 style="text-align:center ;">NIT 901.195.686-7</h1>
           <h1 style="text-align:center ;">ANALISIS DIFERENCIAS INVENTARIO FISICO {{tag}}</h1>
           <h1 style="display:flex;justify-content: flex-end;">  
            <button style="margin-right:20px ;color: white;" mat-button mat-raised-button color="primary" (click)="cerrarInventario()" *ngIf="!verTagInventario(tag)">
            <mat-icon>close</mat-icon>
              Cerrar Conteo
          </button> 
          <button style="margin-right:20px ;color: white; background-color: tomato;" mat-button mat-raised-button  (click)="deleteInventario()">
            <mat-icon>delete</mat-icon>
             Eliminar Conteo
          </button></h1> 
          <table class="mat-elevation-z8" style="margin: 0 auto;">
            <thead style="padding: 15px; font-size: 1em; border-radius: 10px;">
              <tr>
                <th>ITEMS</th>
                <td style="text-align:rigth ;">{{Definitivas.length  |  number:'0.0-0'}}</td>
                <th>Unds</th>
                <td style="text-align:rigth ;">{{undDefinitivas  |  number:'0.0-0'}}</td>
                <th>Costo USD</th>
                <td style="text-align:rigth ;">{{usdDefinitivas  |  number:'0.0-0'}}</td>
                <th>Costo COP</th>
                <td style="text-align:rigth ;">{{copDefinitivas  |  number:'0.0-0'}}</td>
              </tr>
              <tr>
                <th></th>
                <td></td>
                <th>Conteo</th>
                <td style="text-align:rigth ;">{{undDefinitivasConteo  |  number:'0.0-0'}}</td>
                <th>Conteo USD</th>
                <td style="text-align:rigth ;">{{usdDefinitivasConteo |  number:'0.0-0'}}</td>
                <th>Conteo COP</th>
                <td style="text-align:rigth ;">{{ copDefinitivasConteo |  number:'0.0-0'}}</td>
              </tr>
              <tr>
                <th></th>
                <td></td>
                <th>DIF</th>
                <td style="text-align:rigth ;">{{undDefinitivasConteo - undDefinitivas   |  number:'0.0-0'}}</td>
                <th>DIF USD</th>
                <td style="text-align:rigth ;">{{usdDefinitivasConteo - usdDefinitivas |  number:'0.0-0'}}</td>
                <th>DIF COP</th>
                <td style="text-align:rigth ;">{{copDefinitivasConteo - copDefinitivas |  number:'0.0-0'}}</td>
              </tr>

            </thead>
          </table>
           <table style="width: 90%; margin: 0 auto; font-size: 1.3em;" class="mat-elevation-z8">
              <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                <tr>
                  <th rowspan="2">SKU</th>
                  <th rowspan="2">DESCRIPCION</th>
                  <th colspan="6">DIFERENCIA UNDS</th>
                </tr>
                <tr>
                  <td style="text-align:center ">Negativo</td>
                  <td style="text-align:center ">%</td>
                  <td style="text-align:center ">Positivo</td>
                  <td style="text-align:center ">%</td>
                  <td style="text-align:center ">Neto</td>
                  <td style="text-align:center ">%</td>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of DefinitivoCategorias">
                  <td style="text-align:center ">
                    {{item.subscat}}
                  </td>
                  <td>
                    {{item.titulo}}
                  </td>
                  <td style="text-align:center ">
                    {{item.difUnidades.negativo}}
                  </td>
                  <td style="text-align:center ">{{ (item.difUnidades.negativo / totalUndsnegativo)* 100 |  number:'0.0-2' }}%</td>
                  <td style="text-align:center ">
                    {{item.difUnidades.positivo }}
                  </td>
                  <td style="text-align:center "> {{ (item.difUnidades.positivo / totalUndspositivo)* 100 |  number:'0.0-2' }}%</td>
                  <td style="text-align:center "> {{item.difUnidades.positivo + item.difUnidades.negativo }}</td>
                  <td style="text-align:center ">{{((item.difUnidades.positivo + item.difUnidades.negativo) / (totalUndspositivo + totalUndsnegativo)) * 100 |  number:'0.0-2' }}%</td>
                </tr>
                <tr>
                  <th colspan="2">TOTALES</th>
                  <th> {{totalUndsnegativo }}</th>
                  <th>100%</th>
                  <th> {{totalUndspositivo }}</th>
                  <th>100%</th>
                  <th> {{totalUndspositivo + totalUndsnegativo}}</th>
                  <th>100%</th>
                </tr>
              </tbody>
            </table>

            <table style="width: 90%; margin: 0 auto; font-size: 1.3em;" class="mat-elevation-z8">
              <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                <tr>
                  <th rowspan="2">SKU</th>
                  <th rowspan="2">DESCRIPCION</th>
                  <th colspan="6">DIFERENCIA COP</th>
                </tr>
                <tr>
                  <td style="text-align:center ">Negativo</td>
                  <td style="text-align:center ">%</td>
                  <td style="text-align:center ">Positivo</td>
                  <td style="text-align:center ">%</td>
                  <td style="text-align:center ">Neto</td>
                  <td style="text-align:center ">%</td>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of DefinitivoCategorias">
                  <td style="text-align:center ">
                    {{item.subscat}}
                  </td>
                  <td>
                    {{item.titulo}}
                  </td>
                  <td style="text-align:center ">
                    {{item.difCOP.negativo |  number:'0.0-0'}}
                  </td>
                  <td style="text-align:center "></td>
                  <td style="text-align:center ">
                    {{item.difCOP.positivo |  number:'0.0-0'}}
                  </td>
                  <td style="text-align:center "></td>
                  <td style="text-align:center "> {{item.difCOP.positivo + item.difCOP.negativo |  number:'0.0-0'}}</td>
                  <td style="text-align:center ">{{((item.difCOP.positivo + item.difCOP.negativo) / (totalCOPpositivo + totalCOPnegativo)) * 100 |  number:'0.0-2' }}%</td>
                </tr>
                <tr>
                  <th colspan="2">TOTALES</th>
                  <th> {{totalCOPnegativo |  number:'0.0-0' }}</th>
                  <th>100%</th>
                  <th> {{totalCOPpositivo |  number:'0.0-0'}}</th>
                  <th>100%</th>
                  <th> {{totalCOPpositivo + totalCOPnegativo |  number:'0.0-0'}}</th>
                  <th>100%</th>
                </tr>
              </tbody>
            </table>

            <table style="width: 90%; margin: 0 auto; font-size: 1.3em;" class="mat-elevation-z8">
              <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                <tr>
                  <th rowspan="2">SKU</th>
                  <th rowspan="2">DESCRIPCION</th>
                  <th colspan="6">DIFERENCIA USD</th>
                </tr>
                <tr>
                  <td style="text-align:center ">Negativo</td>
                  <td style="text-align:center ">%</td>
                  <td style="text-align:center ">Positivo</td>
                  <td style="text-align:center ">%</td>
                  <td style="text-align:center ">Neto</td>
                  <td style="text-align:center ">%</td>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of DefinitivoCategorias">
                  <td style="text-align:center ">
                    {{item.subscat}}
                  </td>
                  <td>
                    {{item.titulo}}
                  </td>
                  <td style="text-align:center ">
                    {{item.difUSD.negativo |  number:'0.0-2'}}
                  </td>
                  <td style="text-align:center "></td>
                  <td style="text-align:center ">
                    {{item.difUSD.positivo |  number:'0.0-2' }}
                  </td>
                  <td style="text-align:center "></td>
                  <td style="text-align:center "> {{item.difUSD.positivo + item.difUSD.negativo |  number:'0.0-2'}}</td>
                  <td style="text-align:center ">{{((item.difUSD.positivo + item.difUSD.negativo) / (totalUSDpositivo + totalUSDnegativo)) * 100 |  number:'0.0-2' }}%</td>
                </tr>
                <tr>
                  <th colspan="2">TOTALES</th>
                  <th> {{totalUSDnegativo |  number:'0.0-2' }}</th>
                  <th>100%</th>
                  <th> {{totalUSDpositivo |  number:'0.0-2'}}</th>
                  <th>100%</th>
                  <th> {{totalUSDpositivo + totalUSDnegativo |  number:'0.0-2'}}</th>
                  <th>100%</th>
                </tr>
              </tbody>
            </table>
              <h1 style="text-align:center;">Detalle Diferencias</h1>
            <table class="mat-elevation-z8" style="width: 90%; margin: 0 auto; font-size: 0.8em;" class="mat-elevation-z8">
              <thead style="padding: 15px; font-size: 1em; border-radius: 10px;">
                <tr *ngIf="Definitivas.length != 0">
                  <th>
                     <span style="display:flex; align-items: center;">SKU
                    <!-- <mat-form-field style="text-align: center; color: black;width: 90px;">
                      <input matInput  type="text" name="unds" [(ngModel)]="searcSKU">
                      <button  matSuffix mat-icon-button aria-label="Clear">
                        <mat-icon>search</mat-icon>
                      </button>
                    </mat-form-field> -->
                  </span> 
                  </th>
                  <th> 
                    <span style="display:flex; align-items: center;">EAN 
                    
                    <!-- <mat-form-field style="text-align: center; color: black;width: 130px;">
                      <input matInput  type="text" name="unds" [(ngModel)]="searcEan">
                      <button  matSuffix mat-icon-button aria-label="Clear">
                        <mat-icon>search</mat-icon>
                      </button>
                    </mat-form-field> -->
                  </span> 
                  </th>
                  <th>CATEGORIA</th>
                  <th>PRODUCTO</th>
                  <th>
                    <span  style="display:flex; justify-content: center; align-items: center;">
                      EXISTENCIA
                      <button *ngIf="Definitivas[0].Exist_Final > Definitivas[Definitivas.length-1].Exist_Final" mat-icon-button aria-label="Clear" (click)="filterExistDefinitivos()">
                        <mat-icon>arrow_upward</mat-icon>
                      </button>
                      <button *ngIf="Definitivas[0].Exist_Final < Definitivas[Definitivas.length-1].Exist_Final" mat-icon-button aria-label="Clear" (click)="filterExistDefinitivos()">
                        <mat-icon>arrow_downward</mat-icon>
                      </button>
                    </span>
                  </th>
                  <th>CONTEO</th>
                  <th>DIFERENCIA</th>
        
                  <th style="border: 1px solid grey;">COST UND USD</th>
                  <th style="border: 1px solid grey;">
                    <span style="display:flex; justify-content: center; align-items: center;">
                    COST UND COP
                    <button *ngIf="Definitivas[0].COST_PROM > Definitivas[Definitivas.length-1].COST_PROM" mat-icon-button aria-label="Clear" (click)="filterExistDefinitivos()">
                      <mat-icon>arrow_upward</mat-icon>
                    </button>
                    <button *ngIf="Definitivas[0].COST_PROM < Definitivas[Definitivas.length-1].COST_PROM" mat-icon-button aria-label="Clear" (click)="filterExistDefinitivos()">
                      <mat-icon>arrow_downward</mat-icon>
                    </button>
                  </span>
                  </th>
                  <th style="border: 1px solid grey;"> TOTAL USD</th>
                  <th style="border: 1px solid grey;"> TOTAL COP</th>
                  <th style="border: 1px solid grey;">JUSTIFICACION</th>
                </tr>
              </thead>
              <tbody>

                <ng-template  let-element let-last="last" ngFor [ngForOf]="Definitivas" >
                  <tr *ngIf="element.Diferencia != 0">
                    <td style="border-bottom: 1px solid grey;"> {{element.Codigo1}}</td>
                    <td style="border-bottom: 1px solid grey;"> {{element.EAN}}</td>
                    <td style="border-bottom: 1px solid grey;"> {{element.Cla}}</td>
                    <td style="border-bottom: 1px solid grey;"> {{element.Descripcion_1}}</td>
                    <td style="text-align: center; border-bottom: 1px solid grey;"> {{element.Exist_Final}}</td>
                    <td style="border-bottom: 1px solid grey;">   
                      <span class="selec">
                      {{element.Conteo}}
                      </span>
                    </td>
                    <td style="border-bottom: 1px solid grey;" [class._50]="element.Conteo - element.Exist_Final <= -1" [class._100]="element.Conteo - element.Exist_Final == 0"  [class._90]="element.Conteo - element.Exist_Final >= 1" style="border-bottom: 1px solid grey;"> {{element.Conteo - element.Exist_Final}} </td>
                    
                    <td style="text-align:right; border-bottom: 1px solid grey;">
                      {{element.TOTAL_FINAL_INV_USD / element.Diferencia  |  number:'0.0-2'}}
                    </td>
                    <td style="text-align:right; border-bottom: 1px solid grey;">
                      {{element.TOTAL_FINAL_INV / element.Diferencia |  number:'0.0-0'}}
                    </td>
                    <td style="text-align:right; border-bottom: 1px solid grey;">
                      <span *ngIf="element.Diferencia >= 1">{{element.TOTAL_FINAL_INV_USD |  number:'0.0-2'}}</span>
                      <span *ngIf="element.Diferencia <= -1">{{element.TOTAL_FINAL_INV_USD * -1 |  number:'0.0-2'}}</span>
                      
                    </td>
                    <td style="text-align:right; border-bottom: 1px solid grey;">
                      <span *ngIf="element.Diferencia >= 1">{{element.TOTAL_FINAL_INV  |  number:'0.0-0'}}</span>
                      <span *ngIf="element.Diferencia <= -1">{{element.TOTAL_FINAL_INV * -1 |  number:'0.0-0'}}</span>
                      
                    </td>
                    <td style="border-bottom: 1px solid grey;"> 
                      {{element.justificacion}}
                    </td>
                    <!-- <td [class._50]="element.Definitivo.length - element.Exist <= -1" [class._100]="element.Definitivo.length - element.Exist == 0"> {{element.Definitivo.length - element.Exist}} </td> -->
                  </tr>
                </ng-template>
             
  
              </tbody>
  
            </table>
        </div>

      </mat-card-content>
    </mat-tab>
    <mat-tab label="TOMA INVENTARIO" *ngIf="toma">
      <mat-card-content style="display:flex;flex-wrap:wrap;justify-content: center; margin: 10px auto;">
        <mat-form-field appearance="fill">
          <mat-label>Tag Base Datos</mat-label>
        <mat-select [(ngModel)]="tag">
          <ng-template let-doc let-i="index" ngFor [ngForOf]="collections">
          <mat-option  [value]="doc" *ngIf="!verTagInventario(doc)">
            {{doc}}
          </mat-option>
          </ng-template>
        </mat-select>
      </mat-form-field> 
      <mat-form-field *ngIf="tag" appearance="fill" style="text-align: center; font-size: 1em; margin-right: 20px; width: 200px;">
        <input matInput placeholder="Ubicacion" type="text" name="ubicacion" [(ngModel)]="ubicacion">
      </mat-form-field>
      <mat-form-field *ngIf="tag" appearance="fill" style="text-align: center; font-size: 1em; margin-right: 20px; width: 200px;">
        <input matInput placeholder="Unds" type="number" name="unds" [(ngModel)]="unds">
        
      </mat-form-field>
      <button *ngIf="unds"  mat-fab aria-label="Clear" (click)="undsAdd()">
        <mat-icon>add_circle</mat-icon>
      </button>
      <button style="margin-left:10px ;" *ngIf="ubicacion"  mat-fab aria-label="Clear" (click)="focus()">
        <mat-icon>center_focus_strong</mat-icon>
      </button>
        <mat-form-field *ngIf="ubicacion" appearance="fill" style="text-align: center; font-size: 1em; margin-right: 20px; width: 60%;">
          <input matInput placeholder="SCAN" type="text" #scanEle name="scan" [(ngModel)]="scan" (change)="saveScan()">
          <button *ngIf="scaner"  matSuffix mat-icon-button aria-label="Clear" (click)="scaner = !scaner">
            <mat-icon>qr_code_scanner</mat-icon>
          </button>
          <button *ngIf="!scaner" matSuffix mat-icon-button aria-label="Clear" (click)="scaner = !scaner">
            <mat-icon>document_scanner</mat-icon>
          </button>
        </mat-form-field>
        <button *ngIf="scan" flex mat-raised-button color="accent" [disabled]="log"  (click)="saveScan()" class="text-upper" style="width: 90%; margin:15px auto;margin-left: 20px;">Contar <mat-icon>send</mat-icon></button>
      </mat-card-content>

      <table *ngIf="ultimosConteos.length !=0" class="mat-elevation-z8" style="margin:0 auto;">
        <thead style="background-color:rgb(12, 1, 1); color: chartreuse;">
          <tr>
            <th>SKU</th>
            <th>EAN</th>
            <th>PRODUCTO</th>
            <th *ngIf="!verPrecio(tag)">PRECIO</th>
            <th>UND SCAN</th>
            <th>FECHA</th>
            <th>CONTEO</th>
          </tr>
        </thead>
        <tbody>
          <ng-template  let-shoe let-last="last" ngFor [ngForOf]="ultimosConteos" >
          <tr>
            <td style="border-bottom:1px solid grey ;">{{shoe.Codigo1}} </td>
            <td style="border-bottom:1px solid grey ;">{{shoe.EAN}}</td>
            <td style="border-bottom:1px solid grey ;">{{shoe.Descripcion_1}}</td>
            <td style="border-bottom:1px solid grey ; text-align: center;" *ngIf="!verPrecio(tag)" >{{shoe.PRECIO |  number:'0.0-2'}}</td>
            <td style="border-bottom:1px solid grey ;">[ {{shoe.Conteo0[shoe.Conteo0.length -1].unds}} unds ]  </td>
            <td style="border-bottom:1px solid grey ;">  {{shoe.Conteo0[shoe.Conteo0.length -1].time | date:"mediumTime"}}</td>
            <td style="border-bottom:1px solid grey ; text-align: center;"> {{cuantas(shoe.Conteo0)}} Unds</td>
          </tr>
          </ng-template>
        </tbody>
      </table>

    </mat-tab>
  </mat-tab-group>
</mat-card>

<div id="faltantes" style="font-family: Verdana, Geneva, Tahoma, sans-serif;">
  <h1 style="text-align:center ;"> DUTY FREE PARTNERS COLOMBIA SAS</h1>
           <h1 style="text-align:center ;">NIT 901.195.686-7</h1>
           <h1 style="text-align:center ;">ANALISIS DIFERENCIAS INVENTARIO FISICO {{tag}}</h1>
<table style="font-size:1.5em ;">
  <thead>
    <tr>
      <th style="border: solid 1px grey ;">SKU</th>
      <th style="border: solid 1px grey ;">EAN</th>
      <th style="border: solid 1px grey ;">PRODUCTO</th>
    </tr>
  </thead>
  <tbody>
    <ng-template  let-element let-last="last" ngFor [ngForOf]="Faltantes" >
      <tr>
        <td style="border-bottom: 1px solid grey;">
          {{element.Codigo1}}
        </td>
        <td style="border-bottom: 1px solid grey;">{{element.EAN}}</td>
        <td style="border-bottom: 1px solid grey;">{{element.Descripcion_1}}</td>
       </tr>
    </ng-template>
  </tbody>
</table>
<p class="push-top-ms">Realiza:</p>
<p> ________________________________</p>
<p>ID: _____________________________</p>
<p>Firma:</p>
<p> ________________________________</p> 
<h3>{{date | date:'medium'}}</h3> 
</div>

<div id="sobrantes">
  <h1 style="text-align:center ;"> DUTY FREE PARTNERS COLOMBIA SAS</h1>
           <h1 style="text-align:center ;">NIT 901.195.686-7</h1>
           <h1 style="text-align:center ;">ANALISIS DIFERENCIAS INVENTARIO FISICO {{tag}}</h1>
<table style="font-size:1.5em ;">
  <thead>
    <tr>
      <th style="border: solid 1px grey ;">SKU</th>
      <th style="border: solid 1px grey ;">EAN</th>
      <th style="border: solid 1px grey ;">PRODUCTO</th>
    </tr>
  </thead>
  <tbody>
    <ng-template  let-element let-last="last" ngFor [ngForOf]="Sobrantes" >
      <tr>
        <td style="border-bottom: 1px solid grey;">
          {{element.Codigo1}}
        </td>
        <td style="border-bottom: 1px solid grey;">{{element.EAN}}</td>
        <td style="border-bottom: 1px solid grey;">{{element.Descripcion_1}}</td>
       </tr>
    </ng-template>
  </tbody>
</table>
<p class="push-top-ms">Realiza:</p>
<p> ________________________________</p>
<p>ID: _____________________________</p>
<p>Firma:</p>
<p> ________________________________</p> 
<h3>{{date | date:'medium'}}</h3> 
</div>

<div id="definitivos">
  <h1 style="text-align:center ;"> DUTY FREE PARTNERS COLOMBIA SAS</h1>
           <h1 style="text-align:center ;">NIT 901.195.686-7</h1>
           <h1 style="text-align:center ;">ANALISIS DIFERENCIAS INVENTARIO FISICO {{tag}}</h1>
           <table class="mat-elevation-z8" style="margin: 0 auto;">
            <thead style="padding: 15px; font-size: 1em; border-radius: 10px;">
              <tr>
                <th>ITEMS</th>
                <td style="text-align:rigth ;">{{Definitivas.length  |  number:'0.0-0'}}</td>
                <th>Unds</th>
                <td style="text-align:rigth ;">{{undDefinitivas  |  number:'0.0-0'}}</td>
                <th>Costo USD</th>
                <td style="text-align:rigth ;">{{usdDefinitivas  |  number:'0.0-0'}}</td>
                <th>Costo COP</th>
                <td style="text-align:rigth ;">{{copDefinitivas  |  number:'0.0-0'}}</td>
              </tr>
              <tr>
                <th></th>
                <td></td>
                <th>Conteo</th>
                <td style="text-align:rigth ;">{{undDefinitivasConteo  |  number:'0.0-0'}}</td>
                <th>Conteo USD</th>
                <td style="text-align:rigth ;">{{usdDefinitivasConteo |  number:'0.0-0'}}</td>
                <th>Conteo COP</th>
                <td style="text-align:rigth ;">{{ copDefinitivasConteo |  number:'0.0-0'}}</td>
              </tr>
              <tr>
                <th></th>
                <td></td>
                <th>DIF</th>
                <td style="text-align:rigth ;">{{undDefinitivasConteo - undDefinitivas   |  number:'0.0-0'}}</td>
                <th>DIF USD</th>
                <td style="text-align:rigth ;">{{usdDefinitivasConteo - usdDefinitivas |  number:'0.0-0'}}</td>
                <th>DIF COP</th>
                <td style="text-align:rigth ;">{{copDefinitivasConteo - copDefinitivas |  number:'0.0-0'}}</td>
              </tr>

            </thead>
          </table>

  <table>
  <thead>
    <tr>
      <th style="border: solid 1px grey ;">SKU</th>
      <th style="border: solid 1px grey ;">EAN</th>
      <th style="border: solid 1px grey ;">PRODUCTO</th>
      <th style="border: solid 1px grey ;">EXIST</th>
      <th style="border: solid 1px grey ;">CONTEO</th>
      <th style="border: solid 1px grey ;">DIF</th>
      <th  style="border: solid 1px grey ;"> DIF COP</th>
      <th  style="border: solid 1px grey ;">JUSTIFICACION</th>
    </tr>
  </thead>
  <tbody>
    <ng-template  let-element let-last="last" ngFor [ngForOf]="Definitivas" >
      <tr>
        <td style="border-bottom: 1px solid grey;">
          {{element.Codigo1}}
        </td>
        <td style="border-bottom: 1px solid grey;">{{element.EAN}}</td>
        <td style="border-bottom: 1px solid grey;">{{element.Descripcion_1}}</td>
        <td style="border-bottom: 1px solid grey;">{{element.Exist_Final}}</td>
        <td style="border-bottom: 1px solid grey;">{{ element.Conteo}}</td>
        <td style="border-bottom: 1px solid grey;">{{ element.Conteo - element.Exist_Final}}</td>
        <td style="border-bottom: 1px solid grey; text-align:rigth ;">{{ (element.Conteo - element.Exist_Final) * element.Final_Unit_Cost |  number:'0.0-0' }}</td>
        <td style="border-bottom: 1px solid grey;"> 
         {{element.justificacion}}
        </td>
      </tr>
    </ng-template>
  </tbody>
</table>
<p class="push-top-ms">Realiza:</p>
<p> ________________________________</p>
<p>ID: _____________________________</p>
<p>Firma:</p>
<p> ________________________________</p> 
<h3>{{date | date:'medium'}}</h3> 
</div>
