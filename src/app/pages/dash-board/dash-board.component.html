
<mat-progress-bar mode="indeterminate" *ngIf="log" ></mat-progress-bar> 
<div style="display: flex; justify-content: center;">
  <button mat-button [matMenuTriggerFor]="menuRef"><mat-icon class="mat-18">menu</mat-icon> <span>Colecciones</span> </button>

  <mat-menu #menuRef="matMenu">
    <ng-template let-doc let-i="index" ngFor [ngForOf]="collections">
        <button *ngIf="doc != 'users' && doc != 'documentos' && doc != 'operaciones' && doc != 'Presupuestos'  && doc != 'Config'" mat-menu-item (click)="passDataCollections(doc)">
            <mat-icon class="mat-18">check</mat-icon>  
            {{doc}}   
        </button>
    </ng-template> 
  </mat-menu>
</div>
  <mat-tab-group *ngIf="informeCateg" mat-align-tabs="center">
    <mat-tab label="Cumplimiento"> 
      <div style="width: 90%; margin: 0 auto;">
        <h2 tyle="text-align: center;">CUMPLIMIENTO PRESUPUESTAL {{coleccion}}</h2>
        <ngx-charts-bar-horizontal-2d
        [view]="viewBa"
        [scheme]="colorScheme"
        [results]="multy"
        [gradient]="gradient"
        [xAxis]="showXAxis"
        [yAxis]="showYAxis"
        [legend]="showLegend"
        [showXAxisLabel]="showXAxisLabel"
        [showYAxisLabel]="showYAxisLabel"
        [xAxisLabel]="xAxisLabel"
        [yAxisLabel]="yAxisLabel"
        [legendTitle]="legendTitle"
        (select)="onSelect($event)"
        (activate)="onActivate($event)"
        (deactivate)="onDeactivate($event)">
      </ngx-charts-bar-horizontal-2d>
    </div> 
     
    </mat-tab>
    <mat-tab label="Presupuesto">
      <mat-card-content *ngIf="presupuesto">
        <h3 style="text-align: center;">CUMPLIMIENTO PRESUPUESTAL {{coleccion}} DIA {{dia}}</h3>
        <h1 style="text-align: center;"> {{presupuesto.categorias.length}} CATEGORIAS</h1>
        <mat-chip-list aria-label="Fish selection" style="display:flex;justify-content: center;">
          <mat-chip *ngIf="acumulado" color="accent" (click)="acumulador()">
            <mat-chip-avatar>
              <img src="assets/metas.svg" alt="Photo of a Shiba Inu"/>
          </mat-chip-avatar>
            ACUMULADO</mat-chip>
            <mat-chip color="warn" *ngIf="!acumulado" (click)="acumulador()">
              <mat-chip-avatar>
                <img src="assets/metas.svg" alt="Photo of a Shiba Inu"/>
            </mat-chip-avatar>
              TENDENCIA</mat-chip>
        </mat-chip-list>
        <div *ngIf="acumulado">
          <table style="width: 90%; margin: 0 auto; font-size: 1.3em;" class="mat-elevation-z8">
            <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
              <tr>
                <td>PRESUPUESTO </td>
                <td>{{presupuesto.tag}} </td>
                <td>PPTO COP:  <span style="color: chartreuse;">{{presupuesto.presupuesto_cop  | number:'0.0-0'}}</span></td>
                <td>PPTO USD:  <span style="color: chartreuse;">{{presupuesto.presupuesto_usd  | number:'0.0-0'}}</span></td>
                <td>PPTO DIAS: <span style="color: chartreuse;">{{presupuesto.dias  | number:'0.0-0'}}</span> </td>
                <td  colspan="2">ESTADO: {{presupuesto.estado}}</td>
              </tr>
              <tr>
                <td colspan="2">Resultados 
                  <span style="color: chartreuse;">TRM {{presupuesto.ventas / presupuesto.ventas_usd  | number:'0.0-0'}}</span>
                </td>
                <td>VENTA COP <span style="color: chartreuse;">{{presupuesto.ventas  | number:'0.0-0'}}</span></td>
                <td>VENTA USD <span style="color: chartreuse;">{{presupuesto.ventas_usd  | number:'0.0-0'}}</span></td>
                <td>DIFF <span style="color: chartreuse;">{{presupuesto.ventas_usd - presupuesto.presupuesto_usd | number:'0.0-0'}}</span></td>
                <td colspan="2" >CUMPLIMIENTO <span style="color: chartreuse;">{{( presupuesto.ventas_usd / presupuesto.presupuesto_usd)*100 | number:'0.0-0'}}%</span></td>
              </tr>
              <tr>
                <th colspan="1"> CATEGORIA</th>
                <th colspan="1"> % PART PT</th>
                <th colspan="1"> PPT USD</th>
                <th colspan="1"> VENTAS</th>
                <th colspan="1"> CUMPLIMIENTO</th>
                <th colspan="1"> RESTA</th>
                <th colspan="1"> % VENTAS</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of presupuesto.categorias" class="pointer">
               <td>{{item.titulo}}</td>
               <td style="text-align:center">{{item.participacion}}%</td>
               <td style="text-align:right">{{item.presupuesto_usd  | number:'0.0-0'}}</td>
               <td style="text-align:right">{{item.ventas  | number:'0.0-0'}}</td>
               <td  class="normal"  [class._50]="(item.ventas / item.presupuesto_usd) <= 0.80"   [class._100]="(item.ventas / item.presupuesto_usd) >= 0.99" [class._90]="(item.ventas / item.presupuesto_usd) >= 0.80 && (item.ventas / item.presupuesto_usd) <= 0.99" >{{(item.ventas / item.presupuesto_usd)*100 | number:'0.0-0'}}%</td>
               <td style="text-align:right">{{(item.ventas - item.presupuesto_usd) | number:'0.0-0'}}</td>
               <td style="text-align:center">{{(item.ventas / presupuesto.ventas_usd) * 100 | number:'0.0-0'}}%</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div *ngIf="!acumulado">
          <table style="width: 90%; margin: 0 auto; font-size: 1.3em;" class="mat-elevation-z8">
            <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
              <tr>
                <td>TENDENCIA PPTO </td>
                <td>{{presupuesto.tag}} </td>
                <td>PPTO COP:  <span style="color: chartreuse;">{{presupuesto.presupuesto_cop  | number:'0.0-0'}}</span></td>
                <td>PPTO USD:  <span style="color: chartreuse;">{{presupuesto.presupuesto_usd | number:'0.0-0'}}</span></td>
                <td>PPTO DIAS: <span style="color: chartreuse;">{{dia  | number:'0.0-0'}}</span> </td>
                <td  colspan="2">ESTADO: {{presupuesto.estado}}</td>
              </tr>
              <tr>
                <td colspan="2">Resultados 
                  <span style="color: chartreuse;">TRM {{presupuesto.ventas / presupuesto.ventas_usd  | number:'0.0-0'}}</span>
                </td>
                <td>VENTA COP <span style="color: chartreuse;">{{(presupuesto.ventas / dia)* presupuesto.dias | number:'0.0-0'}}</span></td>
                <td>VENTA USD <span style="color: chartreuse;">{{(presupuesto.ventas_usd / dia)* presupuesto.dias  | number:'0.0-0'}}</span></td>
                <td>DIFF <span style="color: chartreuse;">{{((presupuesto.ventas_usd/ dia)* presupuesto.dias) - presupuesto.presupuesto_usd | number:'0.0-0'}}</span></td>
                <td colspan="2" >CUMPLIMIENTO <span style="color: chartreuse;">{{( ((presupuesto.ventas_usd/ dia)* presupuesto.dias) / presupuesto.presupuesto_usd)*100 | number:'0.0-0'}}%</span></td>
              </tr>
              <tr>
                <th colspan="1"> CATEGORIA</th>
                <th colspan="1"> % PART PT</th>
                <th colspan="1"> PPT USD</th>
                <th colspan="1"> VENTAS</th>
                <th colspan="1"> CUMPLIMIENTO</th>
                <th colspan="1"> RESTA</th>
                <th colspan="1"> % VENTAS</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of presupuesto.categorias" class="pointer">
               <td>{{item.titulo}}</td>
               <td style="text-align:center">{{item.participacion}}%</td>
               <td style="text-align:right">{{item.presupuesto_usd  | number:'0.0-0'}}</td>
               <td style="text-align:right">{{(item.ventas / dia)* presupuesto.dias | number:'0.0-0'}}</td>
               <td  class="normal"  [class._50]="((item.ventas / dia)* presupuesto.dias) / item.presupuesto_usd <= 0.80"   [class._100]="((item.ventas / dia)* presupuesto.dias) / item.presupuesto_usd >= 0.99" [class._90]="((item.ventas / dia)* presupuesto.dias) / item.presupuesto_usd >= 0.80 && ((item.ventas / dia)* presupuesto.dias) / item.presupuesto_usd <= 0.99" >{{(((item.ventas / dia)* presupuesto.dias) / item.presupuesto_usd)*100 | number:'0.0-0'}}%</td>

               <td style="text-align:right">{{((item.ventas / dia)* presupuesto.dias) - item.presupuesto_usd | number:'0.0-0'}}</td>
               <td style="text-align:center">{{(((item.ventas / dia) * presupuesto.dias) / ((presupuesto.ventas_usd / dia) * presupuesto.dias)) * 100 | number:'0.0-0'}}%</td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <div style="width: 90%; margin: 0 auto; " class="mat-elevation-z8">
          <h1 style="text-align: center;"> {{presupuesto.tiendas.length}} TIENDAS</h1>
          <mat-accordion *ngIf="presupuesto.tiendas.length != 0">
            <mat-expansion-panel hideToggle *ngFor="let item of presupuesto.tiendas">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  {{item.tienda}} Participacion {{item.part}}% PPTO $ {{ item.presupuesto_usd  | number:'0.0-0'}} USD $ {{ item.usd  | number:'0.0-0'}} <span>  CUMP {{ (item.usd / item.presupuesto_usd)  *100 | number:'0.0-2'}}%</span>
                </mat-panel-title>
              </mat-expansion-panel-header>
              <mat-card-content *ngIf="acumulado">
                <table style="width: 90%; margin: 0 auto;" class="mat-elevation-z8">
                  <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                  <tr>
                    <td> Ventas USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{item.usd  | number:'0.0-2'}}</span></td>
                    <td> Presupuesto USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{item.presupuesto_usd  | number:'0.0-2'}}</span></td>
                    <td> Cumplimiento </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{ (item.usd / item.presupuesto_usd)  *100 | number:'0.0-2'}}%</span></td>
                  </tr>
                  </thead>
                </table>
                <table style="width: 90%; margin: 0 auto;font-size: 1.3em;" class="mat-elevation-z8">
                  <thead>
                    <th>CATEGORÍA</th>
                    <th>% PART</th>
                    <th>PPTO</th>
                    <th>VENTAS</th>
                    <th>RESTA</th>
                    <th>%CUMPLIM</th>
                  
                  </thead>
               
                  <tbody *ngFor="let cat of item.ptto" style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                    <tr>
                      <td>{{cat.titulo}}</td>
                      <td style="text-align: center;">{{cat.participacion  | number:'0.0-2'}}%</td>
                      <td style="text-align:right;">{{cat.presupuesto_usd | number:'0.0-0'}}</td>
                      <td style="text-align:right;">{{cat.ventas | number:'0.0-0'}}</td>
                      <td style="text-align:right;">{{cat.ventas - cat.presupuesto_usd  | number:'0.0-2'}}</td>
                      <td [class._50]="(cat.ventas / cat.presupuesto_usd) <= 0.80" [class._90]="(cat.ventas / cat.presupuesto_usd) >= 0.80 && (cat.ventas / cat.presupuesto_usd) <= 0.99" [class._100]="(cat.ventas / cat.presupuesto_usd) >= 1">{{(cat.ventas / cat.presupuesto_usd)*100  | number:'0.0-2'}} %</td>
                     
                    </tr>
                  </tbody>
                </table> 
               
                    <!-- <table *ngFor="let cat of item.ptto" style="width: 90%; margin: 0 auto;" class="mat-elevation-z8">
                      <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                    
                        <tr>
                          <td colspan="2"> {{cat.participacion}}% Categoria: {{cat.titulo}} $ {{cat.presupuesto_usd  | number:'0.0-0'}}
                  
                          </td>
                        </tr>
                        <tr>
                          <td>Presupuesto USD:  <span style="color: chartreuse;">{{cat.presupuesto_usd  | number:'0.0-0'}}</span></td>
                        
                        <td>USD Dia:  <span style="color: chartreuse;">{{cat.presupuesto_dia_usd  | number:'0.0-0'}}</span></td>
  
                        </tr>
              
                      </thead>
                    </table>  -->
          
           

              </mat-card-content>
              <mat-card-content *ngIf="!acumulado">
                <h3>Tendencia</h3>
                <table style="width: 90%; margin: 0 auto;" class="mat-elevation-z8">
                  <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                  <tr>
                    <td> Ventas USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{((item.usd/ dia) * presupuesto.dias)  | number:'0.0-2'}}</span></td>
                    <td> Presupuesto USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{item.presupuesto_usd  | number:'0.0-2'}}</span></td>
                    <td> Cumplimiento </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{ (((item.usd/ dia) * presupuesto.dias) / item.presupuesto_usd)  *100 | number:'0.0-2'}}%</span></td>
                  </tr>
                  </thead>
                </table>
                <table style="width: 90%; margin: 0 auto;font-size: 1.3em;" class="mat-elevation-z8">
                  <thead>
                    <th>CATEGORÍA</th>
                    <th>% PART</th>
                    <th>PPTO</th>
                    <th>VENTAS</th>
                    <th>RESTA</th>
                    <th>%CUMPLIM</th>
                  
                  </thead>
               
                  <tbody *ngFor="let cat of item.ptto" style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                    <tr>
                      <td>{{cat.titulo}}</td>
                      <td style="text-align: center;">{{cat.participacion  | number:'0.0-2'}}%</td>
                      <td style="text-align:right;">{{cat.presupuesto_usd | number:'0.0-0'}}</td>
                      <td style="text-align:right;">{{((cat.ventas/ dia) * presupuesto.dias) | number:'0.0-0'}}</td>
                      <td style="text-align:right;">{{((cat.ventas/ dia) * presupuesto.dias) - cat.presupuesto_usd  | number:'0.0-2'}}</td>
                      <td [class._50]="(((cat.ventas/ dia) * presupuesto.dias) / cat.presupuesto_usd) <= 0.80" [class._90]="(((cat.ventas/ dia) * presupuesto.dias) / cat.presupuesto_usd) >= 0.80 && (((cat.ventas/ dia) * presupuesto.dias) / cat.presupuesto_usd) <= 0.99" [class._100]="(((cat.ventas/ dia) * presupuesto.dias) / cat.presupuesto_usd) >= 1">{{(((cat.ventas/ dia) * presupuesto.dias) / cat.presupuesto_usd)*100  | number:'0.0-2'}} %</td>
                    </tr>
                  </tbody>
                </table> 
               
                    <!-- <table *ngFor="let cat of item.ptto" style="width: 90%; margin: 0 auto;" class="mat-elevation-z8">
                      <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                    
                        <tr>
                          <td colspan="2"> {{cat.participacion}}% Categoria: {{cat.titulo}} $ {{cat.presupuesto_usd  | number:'0.0-0'}}
                  
                          </td>
                        </tr>
                        <tr>
                          <td>Presupuesto USD:  <span style="color: chartreuse;">{{cat.presupuesto_usd  | number:'0.0-0'}}</span></td>
                        
                        <td>USD Dia:  <span style="color: chartreuse;">{{cat.presupuesto_dia_usd  | number:'0.0-0'}}</span></td>
  
                        </tr>
              
                      </thead>
                    </table>  -->
          
           

              </mat-card-content>
            </mat-expansion-panel>
          </mat-accordion>
        </div>

        <div style="width: 90%; margin: 0 auto; " class="mat-elevation-z8">
          <h1 style="text-align: center;">
            VENDEDORES </h1>
            <table style="width: 90%; margin: 0 auto; font-size: 1.3em;" class="mat-elevation-z8">
              <thead style="padding: 15px; font-size: 1em; border-radius: 10px;">
                <tr>
                  <th>Vendedores</th>
                  <th>{{presupuesto.vendedores.length}}</th>
                  <th>Ventas Usd</th>
                  <th> $ {{totalVendedores |  number:'0.0-2'}} </th>
                </tr>
                <tr>
                  <th>% Comision</th>
                  <th>{{(totalCoisiones / totalVendedores)* 100 |  number:'0.0-2'}}%</th>
                  <th>Comision USD</th>
                  <th> $  {{totalCoisiones |  number:'0.0-2'}}</th>
                </tr>
                <tr>
                  <th>Comisiones COP</th>
                  <th>
                    {{totalCoisionesCOP  |  number:'0.0-0'}}
                  </th>
                  <th>
                    PPTO VENDEDORES
                  </th>
                  <td style="display:flex; justify-content: center;">
                    <span style="color: chartreuse;">{{presupuesto.presupuesto_vendedores | number:'0.0-0'}}</span>
                    <span style="color: orange; margin: 0 10px;display: flex; align-items: center;"> <mat-icon>bed</mat-icon>{{presupuesto.presupuesto_vendedores - presupuesto.presupuesto_usd | number:'0.0-0'}} </span>
                  </td>
                </tr>

              </thead>
            </table>

          
          <div style="text-align: center; margin-top: 10px;">
            <input type="text" placeholder="Buscar" style="font-size:x-large; text-align: center; margin: 0 10px;" [(ngModel)]="search">  
            <mat-form-field >
              <mat-label>Descargar</mat-label>
              <mat-select [disabled]="">
                <mat-option (click)="downloadFile(downloadComisiones, 'Cumplimiento Vendedores')"><mat-icon>cloud_download</mat-icon> Descargar Info Vendedores</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <mat-accordion *ngIf="presupuesto.vendedores.length != 0">
            <ng-template let-item let-last="last" ngFor [ngForOf]="presupuesto.vendedores">
              <mat-expansion-panel hideToggle  *ngIf="buscarRegistro(item.name)">
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    %CUMPLIM:  <span style="color: blue; margin-left: 10px; margin-right: 10px;">{{item.Cumplimiento * 100  | number:'0.0-2'}}%  </span>
                    {{item.identificacion}} - {{item.name}}  PPTO$ {{item.USD  | number:'0.0-0'}} VENTAS {{item.Ventas | number:'0.0-0' }} <span style="color: blue; margin-left: 10px;">{{item.rol}}</span>
                  </mat-panel-title>
                </mat-expansion-panel-header>
                <mat-card-content>
                  <mat-chip-list aria-label="Fish selection" style="display:flex;justify-content: center;">
                    <mat-chip *ngIf="acumulado" color="accent" (click)="acumulador()">
                      <mat-chip-avatar>
                        <img src="assets/metas.svg" alt="Photo of a Shiba Inu"/>
                    </mat-chip-avatar>
                      ACUMULADO</mat-chip>
                      <mat-chip color="warn" *ngIf="!acumulado" (click)="acumulador()">
                        <mat-chip-avatar>
                          <img src="assets/metas.svg" alt="Photo of a Shiba Inu"/>
                      </mat-chip-avatar>
                        TENDENCIA</mat-chip>
                  </mat-chip-list>
                  <div *ngIf="item.rol == 'Ventas'" style="display:flex;flex-direction: column;">
           
                    <div *ngIf="acumulado">
                      <table style="width: 90%; margin: 0 auto; font-size: 1.3em;" class="mat-elevation-z8">
                        <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                        <tr>
                          <td> Ventas USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{item.Ventas  | number:'0.0-2'}}</span></td>
                          <td> PPTO USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{item.USD  | number:'0.0-2'}}</span></td>
                          <!-- <td> % </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{item.Cumplimiento * 100  | number:'0.0-2'}}%</span></td> -->
                        </tr>
                        <tr>
                          <td>Comisiones USD</td> 
                          <td style="text-align: center;"><span style="color: chartreuse;">{{item.Comisiones  | number:'0.0-2'}}</span></td>
                          <td style="text-align: center;"> CUMPLIMIENTO %</td> 
                          <td style="text-align: center;"><span style="color: chartreuse;"> {{item.Cumplimiento * 100  | number:'0.0-2'}}%</span></td>
                          <!-- <td>
                            <button mat-button><mat-icon>person</mat-icon></button>
                    
                          </td> -->
                        </tr>
                        <tr>
                          <td>Comisiones COP <span style="flex: 1 1 auto;"></span> <span style="color: chartreuse; "> TRM {{item.ComisionesCop / item.Comisiones | number:'0.0-0' }}</span></td> 
                          <td style="text-align: center;"><span style="color: chartreuse;">{{item.ComisionesCop | number:'0.0-0'}}</span></td>
                          <td style="text-align: center;"> (Comision / Ventas) %</td> 
                          <td style="text-align: center;"><span style="color: chartreuse;"> {{(item.Comisiones / item.Ventas)* 100   | number:'0.0-2'}} %</span></td>
                        </tr>
                        </thead>
                      </table>
                    <table style="width: 90%; margin: 0 auto; overflow-x: scroll;" class="mat-elevation-z8">
                      <thead>
                        <th>CATEGORÍA</th>
                        <th>% PART</th>
                        <th>PPTO</th>
                        <th>VENTAS</th>
                        <th>RESTA</th>
                        <th>%CUMPLIM</th>
                        <th>% COMISIÓN </th>
                        <th>COMISIÓN USD</th>
                        <!-- <th>COMISIÓN COP</th> -->
                      </thead>
                      <tbody *ngFor="let cat of item.categorias" style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                        <tr>
                          <td>{{cat.titulo}}</td>
                          <td style="text-align: center;">{{cat.participacion  | number:'0.0-2'}}%</td>
                          <td style="text-align:right;">{{cat.presupuesto_usd | number:'0.0-0'}}</td>
                          <td style="text-align:right;">{{cat.ventas | number:'0.0-0'}}</td>
                          <td style="text-align:right;">{{cat.ventas - cat.presupuesto_usd  | number:'0.0-2'}}</td>
                          <td [class._50]="(cat.ventas / cat.presupuesto_usd) <= 0.80" [class._90]="(cat.ventas / cat.presupuesto_usd) >= 0.80 && (cat.ventas / cat.presupuesto_usd) <= 0.999" [class._100]="(cat.ventas / cat.presupuesto_usd) >= 1">{{(cat.ventas / cat.presupuesto_usd)*100  | number:'0.0-2'}} %</td>
                          <td style="text-align: center;">{{(cat.comisionesUsd / cat.ventas)*100 | number:'0.0-2'}}%</td>
                          <td style="text-align:right;">{{cat.comisionesUsd | number:'0.0-0'}}</td>
                          <!-- <td style="text-align:right;">{{cat.comisionesCop | number:'0.0-0'}}</td> -->
                        </tr>
                      </tbody>
                    </table> 
                    
                   
                    </div>
                    <div *ngIf="!acumulado">
                      <table style="width: 90%; margin: 0 auto; font-size: 1.3em;" class="mat-elevation-z8">
                        <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                        <tr>
                          <td> Ventas USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{(item.Ventas/ dia)* presupuesto.dias  | number:'0.0-2'}}</span></td>
                          <td> PPTO USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{(item.USD/ dia)* presupuesto.dias  | number:'0.0-2'}}</span></td>
                          <!-- <td> % </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{item.Cumplimiento * 100  | number:'0.0-2'}}%</span></td> -->
                        </tr>
                        <tr>
                          <td>Comisiones USD</td> 
                          <td style="text-align: center;"><span style="color: chartreuse;">{{(item.Comisiones/ dia)* presupuesto.dias  | number:'0.0-2'}}</span></td>
                          <td style="text-align: center;"> CUMPLIMIENTO %</td> 
                          <td style="text-align: center;"><span style="color: chartreuse;"> {{(item.Cumplimiento/ dia)* presupuesto.dias * 100  | number:'0.0-2'}}%</span></td>
                          <!-- <td>
                            <button mat-button><mat-icon>person</mat-icon></button>
                    
                          </td> -->
                        </tr>
                        <tr>
                          <td>Comisiones COP <span style="flex: 1 1 auto;"></span> <span style="color: chartreuse; "> TRM {{((item.ComisionesCop / dia)* presupuesto.dias) / ((item.Comisiones/ dia)* presupuesto.dias) | number:'0.0-0' }}</span></td> 
                          <td style="text-align: center;"><span style="color: chartreuse;">{{(item.ComisionesCop/ dia)* presupuesto.dias  | number:'0.0-0'}}</span></td>
                          <td style="text-align: center;"> (Comision / Ventas) %</td> 
                          <td style="text-align: center;"><span style="color: chartreuse;"> {{((item.Comisiones/ dia)* presupuesto.dias) / ((item.Ventas/ dia)* presupuesto.dias)* 100   | number:'0.0-2'}} %</span></td>
                        </tr>
                        </thead>
                      </table>
                    <table   style="width: 90%; margin: 0 auto; overflow-x: scroll;" class="mat-elevation-z8">
                      <thead>
                        <th>CATEGORÍA</th>
                        <th>% PART</th>
                        <th>PPTO</th>
                        <th>VENTAS</th>
                        <th>RESTA</th>
                        <th>%CUMPLIM</th>
                        <th>$ PROYECTADO </th>
                        <th>% ESPERADO</th>
                      </thead>
                      <tbody *ngFor="let cat of item.categorias" style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                        <tr>
                          <td>{{cat.titulo}}</td>
                          <td style="text-align: center;">{{cat.participacion  | number:'0.0-2'}}%</td>
                          <td style="text-align:right;">{{(cat.presupuesto_usd / dia)* presupuesto.dias | number:'0.0-0'}}</td>
                          <td style="text-align:right;">{{(cat.ventas / dia)* presupuesto.dias | number:'0.0-0'}}</td>
                          <td style="text-align:right;">{{((cat.ventas/ dia)* presupuesto.dias) - ((cat.presupuesto_usd / dia)* presupuesto.dias)  | number:'0.0-2'}}</td>
                          <td [class._50]="(cat.ventas / ((cat.presupuesto_usd / presupuesto.dias)* dia)) <= 0.80" [class._90]="(cat.ventas / ((cat.presupuesto_usd / presupuesto.dias)* dia)) >= 0.80 && (cat.ventas / ((cat.presupuesto_usd / presupuesto.dias)* dia)) <= 0.99" [class._100]="(cat.ventas / ((cat.presupuesto_usd / presupuesto.dias)* dia)) >= 1">{{(cat.ventas / ((cat.presupuesto_usd / presupuesto.dias)* dia) )*100  | number:'0.0-2'}} %</td>
                          <td style="text-align: center;">{{(cat.ventas / dia)* presupuesto.dias | number:'0.0-0'}}</td>
                          <td style="text-align:right;" [class._50]="(cat.ventas / ((cat.presupuesto_usd / presupuesto.dias)* dia)) <= 0.80" [class._90]="(cat.ventas / ((cat.presupuesto_usd / presupuesto.dias)* dia)) >= 0.80 && (cat.ventas / ((cat.presupuesto_usd / presupuesto.dias)* dia)) <= 0.99" [class._100]="(cat.ventas / ((cat.presupuesto_usd / presupuesto.dias)* dia)) >= 1">{{(((cat.ventas / dia)* presupuesto.dias)/ cat.presupuesto_usd)* 100 | number:'0.0-2'}}%</td>
                        </tr>
                      </tbody>
                    </table> 
                    
                  </div>
                  
                  </div>
                  <div *ngIf="item.rol != 'Ventas'">
                    <div *ngIf="acumulado">
                      <div style="width: 90%; margin: 0 auto; " class="mat-elevation-z8">
                        <h1 style="text-align: center;"> {{item.categorias.length}} TIENDAS</h1>
                        <table style="width: 90%; margin: 0 auto; font-size: 1.3em;" class="mat-elevation-z8">
                          <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                          <tr>
                            <td> Ventas USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{item.Ventas  | number:'0.0-2'}}</span></td>
                            <td> PPTO USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{item.USD  | number:'0.0-2'}}</span></td>
                            <!-- <td> % </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{item.Cumplimiento * 100  | number:'0.0-2'}}%</span></td> -->
                          </tr>
                          
                          <tr>
                            <td>Comisiones USD</td> 
                            <td style="text-align: center;"><span style="color: chartreuse;">{{item.Comisiones  | number:'0.0-2'}}</span></td>
                            <td style="text-align: center;"> CUMPLIMIENTO %</td> 
                            <td style="text-align: center;"><span style="color: chartreuse;"> {{item.Cumplimiento * 100  | number:'0.0-2'}}%</span></td>
                            <!-- <td>
                              <button mat-button><mat-icon>person</mat-icon></button>
                      
                            </td> -->
                          </tr>
                          
                          <tr>
                            <td>Comisiones COP <span style="flex: 1 1 auto;"></span> <span style="color: chartreuse; "> TRM {{item.ComisionesCop / item.Comisiones | number:'0.0-0' }}</span></td> 
                            <td style="text-align: center;"><span style="color: chartreuse;">{{item.ComisionesCop  | number:'0.0-0'}}</span></td>
                            <td style="text-align: center;"> (Comision / Ventas) %</td> 
                            <td style="text-align: center;"><span style="color: chartreuse;"> {{(item.Comisiones / item.Ventas)* 100   | number:'0.0-2'}} %</span></td>
                          </tr>
                          </thead>
                        </table>
                        <mat-accordion *ngIf="item.categorias.length != 0">
                          <mat-expansion-panel hideToggle *ngFor="let itemT of presupuesto.tiendas">
                            <mat-expansion-panel-header>
                              <mat-panel-title>
                                {{itemT.tienda}} Participacion {{itemT.part}}% PPTO $ {{ itemT.presupuesto_usd  | number:'0.0-0'}} USD $ {{ itemT.usd  | number:'0.0-0'}} <span>  CUMP {{ (itemT.usd / itemT.presupuesto_usd)  *100 | number:'0.0-2'}}%</span>
                              </mat-panel-title>
                            </mat-expansion-panel-header>
                            <mat-card-content>
                              <table style="width: 90%; margin: 0 auto;" class="mat-elevation-z8">
                                <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                                <tr>
                                  <td> Ventas USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{itemT.usd  | number:'0.0-2'}}</span></td>
                                  <td> Presupuesto USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{itemT.presupuesto_usd  | number:'0.0-2'}}</span></td>
                                  <td> Cumplimiento </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{ (itemT.usd / itemT.presupuesto_usd)  *100 | number:'0.0-2'}}%</span></td>
                                </tr>
                                <tr>
                                  <td> Ventas COP </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{itemT.ventas_cop  | number:'0.0-2'}}</span></td>
                                </tr>
                                </thead>
                              </table>
                              <table style="width: 90%; margin: 0 auto;font-size: 1.3em;" class="mat-elevation-z8">
                                <thead>
                                  <th>CATEGORÍA</th>
                                  <th>% PART</th>
                                  <th>PPTO</th>
                                  <th>VENTAS</th>
                                  <th>RESTA</th>
                                  <th>%CUMPLIM</th>
                                
                                </thead>
                            
                                <tbody *ngFor="let cat of itemT.ptto" style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                                  <tr>
                                    <td>{{cat.titulo}}</td>
                                    <td style="text-align: center;">{{cat.participacion  | number:'0.0-2'}}%</td>
                                    <td style="text-align:right;">{{cat.presupuesto_usd | number:'0.0-0'}}</td>
                                    <td style="text-align:right;">{{cat.ventas | number:'0.0-0'}}</td>
                                    <td style="text-align:right;">{{cat.ventas - cat.presupuesto_usd  | number:'0.0-2'}}</td>
                                    <td [class._50]="(cat.ventas / cat.presupuesto_usd) <= 0.80" [class._90]="(cat.ventas / cat.presupuesto_usd) >= 0.80 && (cat.ventas / cat.presupuesto_usd) <= 0.99" [class._100]="(cat.ventas / cat.presupuesto_usd) >= 1">{{(cat.ventas / cat.presupuesto_usd)*100  | number:'0.0-2'}} %</td>
                                  
                                  </tr>
                                </tbody>
                              </table> 
                            
                                  <!-- <table *ngFor="let cat of item.ptto" style="width: 90%; margin: 0 auto;" class="mat-elevation-z8">
                                    <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                                  
                                      <tr>
                                        <td colspan="2"> {{cat.participacion}}% Categoria: {{cat.titulo}} $ {{cat.presupuesto_usd  | number:'0.0-0'}}
                                
                                        </td>
                                      </tr>
                                      <tr>
                                        <td>Presupuesto USD:  <span style="color: chartreuse;">{{cat.presupuesto_usd  | number:'0.0-0'}}</span></td>
                                      
                                      <td>USD Dia:  <span style="color: chartreuse;">{{cat.presupuesto_dia_usd  | number:'0.0-0'}}</span></td>
                      
                                      </tr>
                            
                                    </thead>
                                  </table>  -->
                        
                        
                      
                            </mat-card-content>
                          </mat-expansion-panel>
                        </mat-accordion>
                      </div>
                    </div>
                    <div *ngIf="!acumulado">
                      <div style="width: 90%; margin: 0 auto; " class="mat-elevation-z8">
                        <h1 style="text-align: center;"> {{item.categorias.length}} TIENDAS </h1>
                        <table style="width: 90%; margin: 0 auto; font-size: 1.3em;" class="mat-elevation-z8">
                          <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                          <tr>
                            <td> Ventas USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{(item.Ventas /dia  ) * presupuesto.dias   | number:'0.0-2'}}</span></td>
                            <td> PPTO USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{ item.USD    | number:'0.0-0'}}</span></td>
                            <!-- <td> % </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{item.Cumplimiento * 100  | number:'0.0-2'}}%</span></td> -->
                          </tr>
                          <tr>
                            <td>Comisiones USD</td> 
                            <td style="text-align: center;"><span style="color: chartreuse;">{{(item.Comisiones / dia  ) * presupuesto.dias  | number:'0.0-2'}}</span></td>
                            <td style="text-align: center;"> CUMPLIMIENTO %</td> 
                            <td style="text-align: center;"><span style="color: chartreuse;"> {{(( (item.Ventas / dia  ) * presupuesto.dias ) / item.USD)* 100 | number:'0.0-2'}}%</span></td>
                            <!-- <td>
                              <button mat-button><mat-icon>person</mat-icon></button>
                            </td> -->
                          </tr>
        
                          <tr>
                            <td>Comisiones COP <span style="flex: 1 1 auto;"></span> <span style="color: chartreuse; "> TRM {{item.ComisionesCop / item.Comisiones | number:'0.0-0' }}</span></td> 
                            <td style="text-align: center;"><span style="color: chartreuse;">{{(item.ComisionesCop / dia  ) * presupuesto.dias  | number:'0.0-0'}}</span></td>
                            <td style="text-align: center;"> (Comision / Ventas) %</td> 
                            <td style="text-align: center;"><span style="color: chartreuse;"> {{((item.Comisiones/ dia  ) * presupuesto.dias) / ((item.Ventas / dia  ) * presupuesto.dias) * 100   | number:'0.0-2'}} %</span></td>
                          </tr>
                          </thead>
                        </table>
                        <mat-accordion *ngIf="item.categorias.length != 0">
                          <mat-expansion-panel hideToggle *ngFor="let itemT of presupuesto.tiendas">
                            <mat-expansion-panel-header>
                              <mat-panel-title>
                                {{itemT.tienda}} Participacion {{itemT.part}}% PPTO $ {{ itemT.presupuesto_usd  | number:'0.0-0'}} USD $ {{ itemT.usd  | number:'0.0-0'}} <span>  CUMP {{ (itemT.usd / itemT.presupuesto_usd)  *100 | number:'0.0-2'}}%</span>
                              </mat-panel-title>
                            </mat-expansion-panel-header>
                            <mat-card-content>
                              <table style="width: 90%; margin: 0 auto;" class="mat-elevation-z8">
                                <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                                <tr>
                                  <td> Ventas USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{itemT.usd  | number:'0.0-2'}}</span></td>
                                  <td> Presupuesto USD </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{itemT.presupuesto_usd  | number:'0.0-2'}}</span></td>
                                  <td> Cumplimiento </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{ (itemT.usd / itemT.presupuesto_usd)  *100 | number:'0.0-2'}}%</span></td>
                                </tr>
                                <tr>
                                  <td> Ventas COP </td> <td style="text-align: center;"> <span style="color: chartreuse;">{{itemT.ventasCop  | number:'0.0-2'}}</span></td>
                                  <td>  </td>
                                   <td style="text-align: center;"> <span style="color: chartreuse;"></span></td>
                                  <td></td>
                                </tr>
                                </thead>
                              </table>
                              <table style="width: 90%; margin: 0 auto;font-size: 1.3em;" class="mat-elevation-z8">
                                <thead>
                                  <th>CATEGORÍA</th>
                                  <th>% PART</th>
                                  <th>PPTO</th>
                                  <th>VENTAS</th>
                                  <th>RESTA</th>
                                  <th>%CUMPLIM</th>
                                </thead>
                            
                                <tbody *ngFor="let cat of itemT.ptto" style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                                  <tr>
                                    <td>{{cat.titulo}}</td>
                                    <td style="text-align: center;">{{cat.participacion  | number:'0.0-2'}}%</td>
                                    <td style="text-align:right;">{{(cat.presupuesto_usd / presupuesto.dias)* dia | number:'0.0-0'}}</td>
                                    <td style="text-align:right;">{{cat.ventas | number:'0.0-0'}}</td>
                                    <td style="text-align:right;">{{cat.ventas - ((cat.presupuesto_usd / presupuesto.dias)* dia)  | number:'0.0-2'}}</td>
                                    <td style="text-align:right;" [class._50]="(cat.ventas / ((cat.presupuesto_usd / presupuesto.dias)* dia)) <= 0.80" [class._90]="(cat.ventas / ((cat.presupuesto_usd / presupuesto.dias)* dia)) >= 0.80 && (cat.ventas / ((cat.presupuesto_usd / presupuesto.dias)* dia)) <= 0.99" [class._100]="(cat.ventas / ((cat.presupuesto_usd / presupuesto.dias)* dia)) >= 1">{{(((cat.ventas / dia)* presupuesto.dias)/ cat.presupuesto_usd)* 100 | number:'0.0-2'}}%</td>
                                  
                                  </tr>
                                </tbody>
                              </table> 
                            
                                  <!-- <table *ngFor="let cat of item.ptto" style="width: 90%; margin: 0 auto;" class="mat-elevation-z8">
                                    <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1em; border-radius: 10px;">
                                  
                                      <tr>
                                        <td colspan="2"> {{cat.participacion}}% Categoria: {{cat.titulo}} $ {{cat.presupuesto_usd  | number:'0.0-0'}}
                                
                                        </td>
                                      </tr>
                                      <tr>
                                        <td>Presupuesto USD:  <span style="color: chartreuse;">{{cat.presupuesto_usd  | number:'0.0-0'}}</span></td>
                                      
                                      <td>USD Dia:  <span style="color: chartreuse;">{{cat.presupuesto_dia_usd  | number:'0.0-0'}}</span></td>
                      
                                      </tr>
                            
                                    </thead>
                                  </table>  -->
                        
                        
                      
                            </mat-card-content>
                          </mat-expansion-panel>
                        </mat-accordion>
                      </div>
                    </div>
                  </div>
  
                </mat-card-content>
              </mat-expansion-panel>
            </ng-template>
           
           
          </mat-accordion>
        </div>
    </mat-card-content>
    

    </mat-tab>

    <mat-tab label="Vendedores">
      <div style="display:flex; justify-content:center; flex-wrap: wrap; margin-top: 20px; width: 90%; margin: 0 auto;" class="mat-elevation-z8">
        <section class="section">
          <mat-checkbox class="example-margin" [(ngModel)]="showLabels">Etiquetas</mat-checkbox>
          <mat-checkbox class="example-margin" [(ngModel)]="gradient">Gradiente</mat-checkbox>
          <mat-checkbox class="example-margin" [(ngModel)]="showLegend">Leyenda</mat-checkbox>
          <mat-checkbox class="example-margin" [(ngModel)]="isDoughnut">Dona</mat-checkbox>
          <mat-form-field appearance="fill" class="example-margin">
            <mat-label>Descargar</mat-label>
            <mat-select [disabled]="">
              <mat-option (click)="downloadFile(downloadVendedores, 'Vendedores')"><mat-icon>cloud_download</mat-icon> Descargar Info Vendedores</mat-option>
            </mat-select>
          </mat-form-field>
    
          
        </section>
        

        <ngx-charts-advanced-pie-chart
        [view]="view"
        [results]="single"
        [scheme]="colorScheme"
        [gradient]="gradient"
        (select)="onSelect($event)"
        (activate)="onActivate($event)"
        (deactivate)="onDeactivate($event)"
        >
      </ngx-charts-advanced-pie-chart> 
      </div>     
      <div>
        <table style="width: 90%; margin: 0 auto; font-size: 1.3em;"  class="mat-elevation-z8">
          <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1.3em; border-radius: 10px;">
            <tr>
              <td style="text-align:center; padding:5px; ">Codigo</td>
              <td style="text-align:center; padding:5px; ">Vendedor</td>
              <td style="text-align:center; padding:5px; ">Unds</td>
              <td style="text-align:center; padding:5px; ">N°FACT</td>
              <td style="text-align:center; padding:5px; ">USD</td>
              <td style="text-align:center; padding:5px; ">PART %</td>
              <td style="text-align:center; padding:5px; ">ITEM PROMEDIO</td>
              <td style="text-align:center; padding:5px; ">FACT PROMEDIO</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th colspan="4">
                TOTAL VENTAS 
              </th>
              <th>
                {{totalVendedores | number}}
              </th>
            </tr>
            <ng-template let-item let-last="last" ngFor [ngForOf]="informe">
              <tr class="pointer" (click)="passVendedor(item)">
                <td style="text-align:center; padding:5px; ">{{item._id}}</td>
                <td>{{item.Vendedor[0]}}</td>
               
                <td style="text-align:center;">{{item.Unidades}}</td>
                <td style="text-align:center;">{{item.folios}}</td>
                <td style="text-align:right;">{{item.Ventas | number:'0.0-0'}}</td>
                <td style="text-align:right;">{{(item.Ventas / totalVendedores)*100 | number:'0.0-2'}}%</td>
               
                <td style="text-align:right;"> $ {{item.Ventas / item.Unidades | number:'0.0-2'}}</td>
                <td style="text-align:right;"> $ {{item.Ventas / item.folios | number:'0.0-2' }}</td>
              </tr>
           
      
            </ng-template>
           
          </tbody>
        </table>
      </div>
      <div style="display:flex; justify-content:center; flex-wrap: wrap; margin-top: 20px; width: 90%; margin: 0 auto;" class="mat-elevation-z8">
        <mat-card-content>
          <section class="section">
            <mat-checkbox class="example-margin" [(ngModel)]="showLabels">Etiquetas</mat-checkbox>
            <mat-checkbox class="example-margin" [(ngModel)]="gradient">Gradiente</mat-checkbox>
            <mat-checkbox class="example-margin" [(ngModel)]="showLegend">Leyenda</mat-checkbox>
            <mat-checkbox class="example-margin" [(ngModel)]="isDoughnut">Dona</mat-checkbox>
            <mat-form-field appearance="fill" class="example-margin">
              <mat-label>Tema</mat-label>
              <mat-select [disabled]="">
                <mat-option value="option1" *ngFor="let item of listColorSquema" (click)="cambiarColores(item)"> {{item.name}}</mat-option>
                
              </mat-select>
            </mat-form-field>
      
            
          </section>
      
        </mat-card-content>
        <ngx-charts-pie-chart
          [view]="view"
          [scheme]="colorScheme"
          [results]="single"
          [gradient]="gradient"
          [legend]="showLegend"

          [labels]="showLabels"
          [doughnut]="isDoughnut"
          (select)="onSelect($event)"
          (activate)="onActivate($event)"
          (deactivate)="onDeactivate($event)"
          >
        </ngx-charts-pie-chart>
      </div>
    </mat-tab>

    <mat-tab label="Cajeros">    
      <div>
        <h3 style="text-align:center;">
          VENTAS CAJEROS
          <mat-form-field appearance="fill" style="margin:0 auto;">
            <mat-label>Descargar</mat-label>
            <mat-select [disabled]="">
              <mat-option (click)="downloadFile(informeCajeros, 'Cajeros')"><mat-icon>cloud_download</mat-icon> Descargar Info Cajeros</mat-option>
            </mat-select>
          </mat-form-field>
          
        </h3>
       
        <table style="width: 90%; margin: 0 auto; font-size: 1.3em;"  class="mat-elevation-z8">
          <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1.3em; border-radius: 10px;">
            <tr>
              <td style="text-align:center; padding:5px; ">CAJERO</td>
              <!-- <td style="text-align:center; padding:5px; ">Vendedor</td> -->
              <td style="text-align:center; padding:5px; ">Unds</td>
              <td style="text-align:center; padding:5px; ">N°FACT</td>
              <td style="text-align:center; padding:5px; ">USD</td>
              <td style="text-align:center; padding:5px; ">PART %</td>
              <td style="text-align:center; padding:5px; ">ITEM PROMEDIO</td>
              <td style="text-align:center; padding:5px; ">FACT PROMEDIO</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th colspan="4">
                TOTAL VENTAS 
              </th>
              <th>
                {{totalCajeros | number}}
              </th>
            </tr>
            <ng-template let-item let-last="last" ngFor [ngForOf]="informeCajeros">
              <tr class="pointer" (click)="passVendedor(item)">
                <td style="text-align:center; padding:5px; ">{{item._id}}</td>
                <!-- <td>{{item.Vendedor[0]}}</td> -->
               
                <td style="text-align:center;">{{item.Unidades}}</td>
                <td style="text-align:center;">{{item.folios}}</td>
                <td style="text-align:right;">{{item.Ventas | number:'0.0-0'}}</td>
                <td style="text-align:right;">{{(item.Ventas / totalVendedores)*100 | number:'0.0-2'}}%</td>
               
                <td style="text-align:right;"> $ {{item.Ventas / item.Unidades | number:'0.0-2'}}</td>
                <td style="text-align:right;"> $ {{item.Ventas / item.folios | number:'0.0-2' }}</td>
              </tr>
           
      
            </ng-template>
           
          </tbody>
        </table>
      </div>
    </mat-tab>

    <mat-tab label="Categoria" *ngIf="identity.rol == 'Admin'"> 
      <div>
        <h1 style="text-align: center;">RESULTADOS POR SUBCATEGORIAS  {{coleccion}} </h1>
        <table style="width: 90%; margin: 0 auto; font-size: 1.3em;" class="mat-elevation-z8">
          <thead style="background-color:rgb(63, 62, 62) ; color:white; padding: 15px; font-size: 1.3em; border-radius: 10px;">
            <tr style="border-radius:20px">
              <td style="text-align:center; padding:5px; ">Codigo</td>
              <td  style="text-align:center; padding:5px; ">Categoria</td>
              <td style="text-align:center; padding:5px; ">Unidades</td>
              <td style="text-align:center; padding:5px; ">Part % </td>
              <td style="text-align:center; padding:5px; ">Total Ventas</td>
              <td style="text-align:center; padding:5px; ">Total COP</td>
              <td style="text-align:center; padding:5px; ">Part % </td>
              <td style="text-align:center; padding:5px; ">Costo</td>
              <td style="text-align:center; padding:5px; ">Utilidad</td>
              <td style="text-align:center; padding:5px; ">Marge</td>

            </tr>
          </thead>
          <tbody>
            <ng-template let-item let-last="last" ngFor [ngForOf]="informeCateg">
              <tr (click)="passRegistro(item)" class="pointer">
                <td style="text-align:center;">{{item.Codigo[0]}}</td>
                <td>{{item._id}}</td>
                <td style="text-align:right;">{{item.Unidades}}</td>
                <td style="text-align:right;">{{(item.Unidades / totalCategoriaUnd) *100 | number:'0.0-2'}} %</td>
                <td style="text-align:right;">{{item.Ventas | number:'0.0-2' }}</td>
                <td style="text-align:right;">{{item.Cop  | number:'0.0-2'}}</td>
                <td style="text-align:right;">{{(item.Cop / totalCategoriaCop) *100  | number:'0.0-2'}} %</td>
                <td style="text-align:right;">{{item.Cost  | number:'0.0-2'}}</td>
                <td style="text-align:right;">{{item.Cop  -item.Cost | number:'0.0-2'}}</td>
                <td style="text-align:right;">{{((item.Cop  -item.Cost)/ item.Cop)*100 | number:'0.0-2'}}%</td>

              </tr>
            </ng-template>
            <tr>
              <tr>
              <th colspan="2">
                TOTAL VENTAS 
              </th>
              
              <th style="text-align:right">
                {{totalCategoriaUnd | number:'0.0-0'}}
              </th>
              <td></td>
              <th style="text-align:right">
                {{totalCategoria | number:'0.0-0'}}
              </th>
              <th style="text-align:right">
                {{totalCategoriaCop| number:'0.0-0'}}
              </th>
              <th></th>
              <th>
                {{totalCategoriaCosto  | number:'0.0-0'}}
              </th>
              <th>
                {{totalCategoriaCop - totalCategoriaCosto  | number:'0.0-0'}}
              </th>
              <th>
                {{((totalCategoriaCop -totalCategoriaCosto)/totalCategoriaCop)*100  | number:'0.0-2'}}%
              </th>

            </tr>
          </tbody>
        </table>
        <h1 style="text-align: center;">RESULTADOS POR SUBCATEGORIAS TIENDA {{coleccion}} </h1>
        <table style="width: 90%; margin: 0 auto; font-size: 1.3em;" class="mat-elevation-z8"  matSort (matSortChange)="sortData($event)">
          <thead style="background-color:rgb(117, 115, 115) ; color:white; padding: 15px; font-size: 1.3em; border-radius: 10px;">
            <tr style="border-radius:20px">
              <td style="text-align:center; padding:5px;"> TIENDA</td>
              <td style="text-align:center; padding:5px;">Codigo</td>
              <td  style="text-align:center; padding:5px; " mat-sort-header="categoria"><mat-icon>sort</mat-icon>  Categoria</td>
              <td style="text-align:center; padding:5px; " mat-sort-header="unds"> <mat-icon>sort</mat-icon> Unds</td>
              <td style="text-align:center; padding:5px; ">Part % </td>
              <td style="text-align:center; padding:5px; "  mat-sort-header="ventas"><mat-icon>sort</mat-icon>  Total Ventas</td>
              <td style="text-align:center; padding:5px; ">Total COP</td>
              <td style="text-align:center; padding:5px; ">Part % </td>
              <td style="text-align:center; padding:5px; "  mat-sort-header="costo"> <mat-icon>sort</mat-icon> Costo</td>
              <td style="text-align:center; padding:5px; ">Utilidad</td>
              <td style="text-align:center; padding:5px; ">Marge</td>

            </tr>
          </thead>
          <tbody>
            <tr>
              <th></th>
            <th colspan="2">
              TOTAL VENTAS 
            </th>
            
            <th style="text-align:right">
              {{totalCategoriaUnd | number:'0.0-0'}}
            </th>
            <td></td>
            <th style="text-align:right">
              {{totalCategoria | number:'0.0-0'}}
            </th>
            <th style="text-align:right">
              {{totalCategoriaCop| number:'0.0-0'}}
            </th>
            <th></th>
            <th>
              {{totalCategoriaCosto  | number:'0.0-0'}}
            </th>
            <th>
              {{totalCategoriaCop -totalCategoriaCosto  | number:'0.0-0'}}
            </th>
            <th>
              {{((totalCategoriaCop -totalCategoriaCosto)/totalCategoriaCop)*100  | number:'0.0-2'}}%
            </th>

          </tr>
            <ng-template let-item let-last="last" ngFor [ngForOf]="informeCategTieda">
              <tr *ngIf="item._id.pv == 'MDE D'" (click)="passRegistro(item)" class="pointer">
                <td>{{item._id.pv}}</td>
                <td style="text-align:center;">{{item.Codigo}}</td>
                <td>{{item._id.sub}} </td>
                <td style="text-align:right;">{{item.Unidades}}</td>
                <td style="text-align:right;">{{(item.Unidades / totalCategoriaUnd) *100 | number:'0.0-2'}} %</td>
                <td style="text-align:right;">{{item.Ventas | number:'0.0-2' }}</td>
                <td style="text-align:right;">{{item.Cop  | number:'0.0-2'}}</td>
                <td style="text-align:right;">{{(item.Cop / totalCategoriaCop) *100  | number:'0.0-2'}} %</td>
                <td style="text-align:right;">{{item.Cost  | number:'0.0-2'}}</td>
                <td style="text-align:right;">{{item.Cop  -item.Cost | number:'0.0-2'}}</td>
                <td style="text-align:right;">{{((item.Cop  -item.Cost)/ item.Cop)*100 | number:'0.0-2'}}%</td>
              </tr>
            </ng-template>
            <tr>
              <th></th>
            <th colspan="2">
              TOTAL VENTAS TIENDA D
            </th>
            
            <th style="text-align:right">
              {{totalTiendaDund | number:'0.0-0'}}
            </th>
            <td></td>
            
            <th style="text-align:right">
              {{totalTiendaDUsd | number:'0.0-0'}}
            </th>

            <th>  {{totalTiendaD | number:'0.0-0'}}</th>
            <th>
              {{(totalTiendaD/totalCategoriaCop)*100  | number:'0.0-2'}}%

            </th>
            <th>
              {{costoTiendaD  | number:'0.0-0'}}
            </th>
            
            <th>
              {{totalTiendaD - costoTiendaA  | number:'0.0-0'}}
            </th>
            
            <th>
              {{((totalTiendaD - costoTiendaD)/totalTiendaD)*100  | number:'0.0-2'}}%
            </th>

          </tr>
            <ng-template let-item let-last="last" ngFor [ngForOf]="informeCategTieda">
              <tr  *ngIf="item._id.pv == 'MDE A'" (click)="passRegistro(item)" class="pointer">
                <td>{{item._id.pv}}</td>
                <td style="text-align:center;">{{item.Codigo}}</td>
                <td>{{item._id.sub}} </td>
                <td style="text-align:right;">{{item.Unidades}}</td>
                <td style="text-align:right;">{{(item.Unidades / totalCategoriaUnd) *100 | number:'0.0-2'}} %</td>
                <td style="text-align:right;">{{item.Ventas | number:'0.0-2' }}</td>
                <td style="text-align:right;">{{item.Cop  | number:'0.0-2'}}</td>
                <td style="text-align:right;">{{(item.Cop / totalCategoriaCop) *100  | number:'0.0-2'}} %</td>
                <td style="text-align:right;">{{item.Cost  | number:'0.0-2'}}</td>
                <td style="text-align:right;">{{item.Cop  -item.Cost | number:'0.0-2'}}</td>
                <td style="text-align:right;">{{((item.Cop  -item.Cost)/ item.Cop)*100 | number:'0.0-2'}}%</td>

              </tr>
            </ng-template>
            <tr>
              <tr>
                <th></th>
              <th colspan="2">
                TOTAL VENTAS TIENDA A
              </th>
              
              <th style="text-align:right">
                {{totalTiendaDund | number:'0.0-0'}}
              </th>
              <td></td>
              
              <th style="text-align:right">
                {{totalTiendaAUsd | number:'0.0-0'}}
              </th>
  
              <th>  {{totalTiendaA | number:'0.0-0'}}</th>
              <th>
                {{( totalTiendaA/totalCategoriaCop)*100  | number:'0.0-2'}}%
  
              </th>
              <th>
                {{costoTiendaA  | number:'0.0-0'}}
              </th>
              
              <th>
                {{totalTiendaA - costoTiendaA  | number:'0.0-0'}}
              </th>
              
              <th>
                {{((totalTiendaA - costoTiendaA)/totalTiendaA)*100  | number:'0.0-2'}}%
              </th>
  
            </tr>
              
             
          </tbody>
        </table>
      </div>


    </mat-tab>


  </mat-tab-group>



<!-- [scheme]="colorScheme" -->